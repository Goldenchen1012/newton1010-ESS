; generated by Component: ARM Compiler 5.06 update 7 (build 960) Tool: ArmCC [4d365d]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\obj\halafebq796xx.o --asm_dir=.\List\ --list_dir=.\List\ --depend=.\obj\halafebq796xx.d --cpu=Cortex-M4.fp.sp --apcs=interwork -O1 --diag_suppress=9931 -I../Inc -I../../../Drivers/CMSIS/Include -I../../../Drivers/CMSIS/Device/ST/STM32L4xx/Include -I../../../Drivers/STM32L4xx_HAL_Driver/Inc -I../../../Drivers/BSP/STM32L4xx_Nucleo_144 -I..\..\..\User -I..\..\..\HAL -I..\..\..\Lib -I..\..\..\Config_Common -I..\..\..\AppProtect -I..\..\..\APP -I..\..\..\Lib\SMP -I..\..\..\Drivers\SMP -I..\..\..\BSP -I..\..\..\Drivers\BSP\STM32L496V_Davinci -I..\..\..\API -I..\..\..\AppCommunication -I..\..\..\Drivers\W5500 -I..\..\..\RTT -I.\RTE\_HVESS_Normal -IC:\Users\88691\AppData\Local\Arm\Packs\ARM\CMSIS\5.8.0\CMSIS\Core\Include -IC:\Users\88691\AppData\Local\Arm\Packs\Keil\STM32L4xx_DFP\2.6.0\Drivers\CMSIS\Device\ST\STM32L4xx\Include -D__MICROLIB -D__UVISION_VERSION=535 -D_RTE_ -DSTM32L496xx -D_RTE_ -DSTM32L496xx -DUSE_HAL_DRIVER -DUSE_STM32L4XX_NUCLEO_144 -DBSPSMPS -DUSE_STM32L4XX_NUCLEO_144_SMPS -DUSE_ADP5301ACBZ -W ..\..\..\HAL\HalAfeBq796xx.c]
                          THUMB

                          AREA ||i.AfeBq796xxIniHandler||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  AfeBq796xxIniHandler PROC
;;;1092   }
;;;1093   static void AfeBq796xxIniHandler(uint16_t evt)
000000  e92d43f0          PUSH     {r4-r9,lr}
;;;1094   {
000004  b09b              SUB      sp,sp,#0x6c
;;;1095   	char	str[100];
;;;1096   	uint8_t res;
;;;1097   	//wake_sw
;;;1098   	//WAKE_TONE_DISABLE
;;;1099   	if(evt == LIB_SW_TIMER_EVT_SW_1MS)
000006  280a              CMP      r0,#0xa
000008  d17e              BNE      |L1.264|
;;;1100   	{  
;;;1101   		GPIOD->ODR ^= GPIO_PIN_14;
00000a  f8df8218          LDR      r8,|L1.548|
00000e  f8d80000          LDR      r0,[r8,#0]
000012  f4804080          EOR      r0,r0,#0x4000
000016  f8c80000          STR      r0,[r8,#0]
;;;1102   		
;;;1103   		if(cnt_delay <= 1)
00001a  4f83              LDR      r7,|L1.552|
00001c  8bf8              LDRH     r0,[r7,#0x1e]  ; cnt_delay
00001e  2801              CMP      r0,#1
000020  d873              BHI      |L1.266|
;;;1104   		{
;;;1105   	        res = drv_bq796xx_Init_Steps(wake_sw,
000022  f7fffffe          BL       apiSysParGetBmuNumber
000026  1c40              ADDS     r0,r0,#1
000028  b2c2              UXTB     r2,r0
00002a  1cb8              ADDS     r0,r7,#2
00002c  1e41              SUBS     r1,r0,#1
00002e  e9cd1000          STRD     r1,r0,[sp,#0]
000032  1e81              SUBS     r1,r0,#2
000034  7a3b              LDRB     r3,[r7,#8]  ; BridgeDirection
000036  7b78              LDRB     r0,[r7,#0xd]  ; wake_sw
000038  f7fffffe          BL       drv_bq796xx_Init_Steps
00003c  4604              MOV      r4,r0
;;;1106   	        							 &afe_steps, 
;;;1107   	        							 afeBmuNumber() + 1, 
;;;1108   	        						  	 BridgeDirection, 
;;;1109   	        							 &step_com_f , 
;;;1110   	        							 &before_d_ms);
;;;1111   			
;;;1112   	        //sprintf(str,"%d %d %d %d", afe_steps, res,step_com_f, before_d_ms); 
;;;1113   			//halAfeBq796xxDebugMsg(str);
;;;1114   			
;;;1115   			cnt_delay = before_d_ms;
00003e  78b8              LDRB     r0,[r7,#2]  ; before_d_ms
000040  83f8              STRH     r0,[r7,#0x1e]
;;;1116   			if(step_com_f == 1)
000042  7878              LDRB     r0,[r7,#1]  ; step_com_f
000044  2801              CMP      r0,#1
000046  d102              BNE      |L1.78|
;;;1117   			{
;;;1118   		   		afe_steps++;
000048  7838              LDRB     r0,[r7,#0]  ; afe_steps
00004a  1c40              ADDS     r0,r0,#1
00004c  7038              STRB     r0,[r7,#0]
                  |L1.78|
;;;1119   			}
;;;1120   			if(afe_steps > AFE_RUN_AUX_ADC)
00004e  7838              LDRB     r0,[r7,#0]  ; afe_steps
000050  282a              CMP      r0,#0x2a
000052  d969              BLS      |L1.296|
;;;1121   			{
;;;1122   				sprintf(str,"Wakeup: %d", wake_sw);
000054  7b7a              LDRB     r2,[r7,#0xd]  ; wake_sw
000056  a175              ADR      r1,|L1.556|
000058  a802              ADD      r0,sp,#8
00005a  f7fffffe          BL       __2sprintf
;;;1123   				halAfeBq796xxDebugMsg(str);
;;;1124   
;;;1125   				if(res&0x80)
00005e  0620              LSLS     r0,r4,#24
000060  f04f0901          MOV      r9,#1                 ;1116
000064  f04f0600          MOV      r6,#0                 ;1116
000068  d502              BPL      |L1.112|
;;;1126   				{
;;;1127   					IsRingDaisyChain = 1;
00006a  f887901b          STRB     r9,[r7,#0x1b]
00006e  e000              B        |L1.114|
                  |L1.112|
;;;1128   					halAfeBq796xxDebugMsg("...........Ring...1");
;;;1129   				}
;;;1130   				else
;;;1131   					IsRingDaisyChain = 0;
000070  76fe              STRB     r6,[r7,#0x1b]
                  |L1.114|
;;;1132   					
;;;1133   				res &= 0x7f;
000072  f004047f          AND      r4,r4,#0x7f
;;;1134   			
;;;1135   				StackCountForIni[BridgeDirection] = res; 
000076  4d6c              LDR      r5,|L1.552|
000078  7a38              LDRB     r0,[r7,#8]  ; BridgeDirection
00007a  3522              ADDS     r5,r5,#0x22
00007c  542c              STRB     r4,[r5,r0]
;;;1136   				if(res == afeBmuNumber())
00007e  f7fffffe          BL       apiSysParGetBmuNumber
000082  42a0              CMP      r0,r4
000084  d100              BNE      |L1.136|
;;;1137   					wake_sw = WAKE_TONE_DISABLE;
000086  737e              STRB     r6,[r7,#0xd]
                  |L1.136|
;;;1138   				//else
;;;1139   				//	wake_sw = WAKE_TONE_ENABLE;
;;;1140   				
;;;1141   				if(BridgeDirection == DIR_NORTH)
000088  7a38              LDRB     r0,[r7,#8]  ; BridgeDirection
00008a  b1b0              CBZ      r0,|L1.186|
;;;1142   				{
;;;1143   					if(res == afeBmuNumber() ||
;;;1144   					   BridgeSwitchCount >= (INI_RETRY_TIMES - 1))
;;;1145   					{
;;;1146   						NorthAndSouthIniFlag |= 0x01;
;;;1147   					}
;;;1148   					sprintf(str,"North Number:%d", res);
;;;1149   					halAfeBq796xxDebugMsg(str);
;;;1150   				}
;;;1151   				else
;;;1152   				{
;;;1153   					if(res == afeBmuNumber() ||
00008c  f7fffffe          BL       apiSysParGetBmuNumber
000090  42a0              CMP      r0,r4
000092  d002              BEQ      |L1.154|
;;;1154   					   BridgeSwitchCount >= (INI_RETRY_TIMES - 1))
000094  7a78              LDRB     r0,[r7,#9]  ; BridgeSwitchCount
000096  2804              CMP      r0,#4
000098  d303              BCC      |L1.162|
                  |L1.154|
;;;1155   					{
;;;1156   						NorthAndSouthIniFlag |= 0x02;
00009a  7af8              LDRB     r0,[r7,#0xb]  ; NorthAndSouthIniFlag
00009c  f0400002          ORR      r0,r0,#2
0000a0  72f8              STRB     r0,[r7,#0xb]
                  |L1.162|
;;;1157   					}
;;;1158   					sprintf(str,"South Number:%d", res);
0000a2  4622              MOV      r2,r4
0000a4  a164              ADR      r1,|L1.568|
0000a6  a802              ADD      r0,sp,#8
0000a8  f7fffffe          BL       __2sprintf
                  |L1.172|
;;;1159   					halAfeBq796xxDebugMsg(str);
;;;1160   				}
;;;1161   				if((NorthAndSouthIniFlag&0x03) == 0x03 && 
0000ac  7af8              LDRB     r0,[r7,#0xb]  ; NorthAndSouthIniFlag
;;;1162   					( (StackCountForIni[DIR_NORTH] == afeBmuNumber()) ||
;;;1163   					  (StackCountForIni[DIR_SOUTH] == afeBmuNumber()) ||
;;;1164   					  ((StackCountForIni[DIR_NORTH] + StackCountForIni[DIR_SOUTH]) ==
;;;1165   					    afeBmuNumber())))
;;;1166   				{					
;;;1167   					halAfeBq796xxDebugMsg("Start run....");
;;;1168   					if(BridgeDirection == DIR_NORTH && StackCountForIni[DIR_NORTH] == 0)
;;;1169   					{
;;;1170   						afe_steps = AFE_INIT_IDLE;
;;;1171   						cnt_delay = 50;
0000ae  f04f0432          MOV      r4,#0x32
0000b2  43c0              MVNS     r0,r0                 ;1161
0000b4  0780              LSLS     r0,r0,#30             ;1161
0000b6  d011              BEQ      |L1.220|
0000b8  e087              B        |L1.458|
                  |L1.186|
0000ba  f7fffffe          BL       apiSysParGetBmuNumber
0000be  42a0              CMP      r0,r4                 ;1143
0000c0  d002              BEQ      |L1.200|
0000c2  7a78              LDRB     r0,[r7,#9]            ;1144  ; BridgeSwitchCount
0000c4  2804              CMP      r0,#4                 ;1144
0000c6  d303              BCC      |L1.208|
                  |L1.200|
0000c8  7af8              LDRB     r0,[r7,#0xb]          ;1146  ; NorthAndSouthIniFlag
0000ca  f0400001          ORR      r0,r0,#1              ;1146
0000ce  72f8              STRB     r0,[r7,#0xb]          ;1146
                  |L1.208|
0000d0  4622              MOV      r2,r4                 ;1148
0000d2  a15d              ADR      r1,|L1.584|
0000d4  a802              ADD      r0,sp,#8              ;1148
0000d6  f7fffffe          BL       __2sprintf
0000da  e7e7              B        |L1.172|
                  |L1.220|
0000dc  f7fffffe          BL       apiSysParGetBmuNumber
0000e0  7829              LDRB     r1,[r5,#0]            ;1162  ; StackCountForIni
0000e2  4288              CMP      r0,r1                 ;1162
0000e4  d00b              BEQ      |L1.254|
0000e6  f7fffffe          BL       apiSysParGetBmuNumber
0000ea  7869              LDRB     r1,[r5,#1]            ;1163  ; StackCountForIni
0000ec  4288              CMP      r0,r1                 ;1163
0000ee  d006              BEQ      |L1.254|
0000f0  f7fffffe          BL       apiSysParGetBmuNumber
0000f4  7829              LDRB     r1,[r5,#0]            ;1164  ; StackCountForIni
0000f6  786a              LDRB     r2,[r5,#1]            ;1164  ; StackCountForIni
0000f8  4411              ADD      r1,r1,r2              ;1164
0000fa  4288              CMP      r0,r1                 ;1164
0000fc  d165              BNE      |L1.458|
                  |L1.254|
0000fe  7a38              LDRB     r0,[r7,#8]            ;1168  ; BridgeDirection
000100  b908              CBNZ     r0,|L1.262|
000102  7829              LDRB     r1,[r5,#0]            ;1168  ; StackCountForIni
000104  b129              CBZ      r1,|L1.274|
                  |L1.262|
;;;1172   						BridgeSwitchCount = 0;
;;;1173   						CHANGE_BRIDGE_DIRECTION();
;;;1174   						return;
;;;1175   					}
;;;1176   					else if(BridgeDirection == DIR_SOUTH && StackCountForIni[DIR_SOUTH] == 0)
000106  e001              B        |L1.268|
                  |L1.264|
000108  e00e              B        |L1.296|
                  |L1.266|
00010a  e087              B        |L1.540|
                  |L1.268|
00010c  2801              CMP      r0,#1
00010e  d00e              BEQ      |L1.302|
000110  e00f              B        |L1.306|
                  |L1.274|
000112  703e              STRB     r6,[r7,#0]            ;1170
000114  83fc              STRH     r4,[r7,#0x1e]         ;1171
000116  727e              STRB     r6,[r7,#9]            ;1172
000118  f8879008          STRB     r9,[r7,#8]            ;1173
00011c  f8d80000          LDR      r0,[r8,#0]            ;1173
000120  f4805000          EOR      r0,r0,#0x2000         ;1173
000124  f8c80000          STR      r0,[r8,#0]            ;1173
                  |L1.296|
;;;1177   					{
;;;1178   						afe_steps = AFE_INIT_IDLE;
;;;1179   						cnt_delay = 50;
;;;1180   						BridgeSwitchCount = 0;
;;;1181   						CHANGE_BRIDGE_DIRECTION();
;;;1182   						return;
;;;1183   					}
;;;1184   					if((NorthAndSouthIniFlag & 0x80) == 0)
;;;1185   					{
;;;1186   						NorthAndSouthIniFlag |= 0x80;
;;;1187   						if(StackCountForIni[DIR_NORTH] == StackCountForIni[DIR_SOUTH] &&
;;;1188   						   StackCountForIni[DIR_NORTH] == (afeBmuNumber() / 2))
;;;1189   						{
;;;1190   							halAfeBq796xxDebugMsg("檢查是否為 ring.......");
;;;1191   							afe_steps = AFE_INIT_IDLE;
;;;1192   							cnt_delay = 50;
;;;1193   							wake_sw = WAKE_TONE_DISABLE;
;;;1194   							CHANGE_BRIDGE_DIRECTION();
;;;1195   							return;
;;;1196   						}
;;;1197   					}
;;;1198   					else
;;;1199   					{
;;;1200   						if(IsRingDaisyChain && 
;;;1201   						  (StackCountForIni[DIR_NORTH] != afeBmuNumber() ||
;;;1202   					       StackCountForIni[DIR_SOUTH] != afeBmuNumber()))
;;;1203   					  	{
;;;1204   				  			changeToBq796xxIniHandler();
;;;1205   					  		halAfeBq796xxDebugMsg("接線錯誤，重新Ini......");
;;;1206   					  		return;
;;;1207   					  	}					
;;;1208   					}					
;;;1209   					if(StackCountForIni[DIR_NORTH] == afeBmuNumber() ||
;;;1210   					   StackCountForIni[DIR_SOUTH] == afeBmuNumber())
;;;1211   					{
;;;1212   						ReaAfeCycleCount10Ms = AFE_READ_CYCLE_COUNT_10MS;
;;;1213   					}
;;;1214   					else
;;;1215   					{
;;;1216   						ReaAfeCycleCount10Ms = AFE_READ_CYCLE_COUNT_10MS / 2;
;;;1217   					}
;;;1218   					AfeTimerHandlerProcessor = AfeBq796xxNormalHandler;
;;;1219   					AfeFunctionProcessor = 0;
;;;1220   					AfeFailTimerCount = 0;
;;;1221   					//RealBmuNumber = res;//afeBmuNumber();
;;;1222   					AfeState = AFE_STATE_NORMAL;
;;;1223   				}
;;;1224   				else
;;;1225   				{
;;;1226   					if(StackCountForIni[BridgeDirection] == afeBmuNumber())
;;;1227   					{
;;;1228   						BridgeSwitchCount = INI_RETRY_TIMES;
;;;1229   					}
;;;1230   					
;;;1231   					afe_steps = AFE_INIT_IDLE;
;;;1232   					cnt_delay = 50;
;;;1233   					BridgeSwitchCount++;
;;;1234   					if(BridgeSwitchCount >= INI_RETRY_TIMES)
;;;1235   					{
;;;1236   						BridgeSwitchCount = 0;
;;;1237   						if(BridgeDirection == DIR_NORTH)
;;;1238   							NorthAndSouthIniFlag |= 0x01;
;;;1239   						else
;;;1240   							NorthAndSouthIniFlag |= 0x02;
;;;1241   						CHANGE_BRIDGE_DIRECTION();
;;;1242   						//halAfeBq796xxDebugMsg("AFE Dir Change");
;;;1243   						sprintf(str,"Ini Dir = %d", BridgeDirection);
;;;1244   						halAfeBq796xxDebugMsg(str);
;;;1245   					}
;;;1246   				}
;;;1247   			}
;;;1248   		}
;;;1249   		else 
;;;1250   			cnt_delay--;		
;;;1251   	}
;;;1252   }
000128  b01b              ADD      sp,sp,#0x6c
00012a  e8bd83f0          POP      {r4-r9,pc}
                  |L1.302|
00012e  7868              LDRB     r0,[r5,#1]            ;1176  ; StackCountForIni
000130  b1e8              CBZ      r0,|L1.366|
                  |L1.306|
000132  7af8              LDRB     r0,[r7,#0xb]          ;1184  ; NorthAndSouthIniFlag
000134  0601              LSLS     r1,r0,#24             ;1184
000136  d425              BMI      |L1.388|
000138  f0400080          ORR      r0,r0,#0x80           ;1186
00013c  72f8              STRB     r0,[r7,#0xb]          ;1186
00013e  7828              LDRB     r0,[r5,#0]            ;1187  ; StackCountForIni
000140  7869              LDRB     r1,[r5,#1]            ;1187  ; StackCountForIni
000142  4288              CMP      r0,r1                 ;1187
000144  d12d              BNE      |L1.418|
000146  f7fffffe          BL       apiSysParGetBmuNumber
00014a  7829              LDRB     r1,[r5,#0]            ;1188  ; StackCountForIni
00014c  ebb10f50          CMP      r1,r0,LSR #1          ;1188
000150  d127              BNE      |L1.418|
000152  703e              STRB     r6,[r7,#0]            ;1191
000154  83fc              STRH     r4,[r7,#0x1e]         ;1192
000156  737e              STRB     r6,[r7,#0xd]          ;1193
000158  7a38              LDRB     r0,[r7,#8]            ;1194  ; BridgeDirection
00015a  f0800001          EOR      r0,r0,#1              ;1194
00015e  7238              STRB     r0,[r7,#8]            ;1194
000160  f8d80000          LDR      r0,[r8,#0]            ;1194
000164  f4805000          EOR      r0,r0,#0x2000         ;1194
000168  f8c80000          STR      r0,[r8,#0]            ;1194
00016c  e7dc              B        |L1.296|
                  |L1.366|
00016e  703e              STRB     r6,[r7,#0]            ;1178
000170  83fc              STRH     r4,[r7,#0x1e]         ;1179
000172  727e              STRB     r6,[r7,#9]            ;1180
000174  723e              STRB     r6,[r7,#8]            ;1181
000176  f8d80000          LDR      r0,[r8,#0]            ;1181
00017a  f4805000          EOR      r0,r0,#0x2000         ;1181
00017e  f8c80000          STR      r0,[r8,#0]            ;1181
000182  e7d1              B        |L1.296|
                  |L1.388|
000184  7ef8              LDRB     r0,[r7,#0x1b]         ;1200  ; IsRingDaisyChain
000186  b160              CBZ      r0,|L1.418|
000188  f7fffffe          BL       apiSysParGetBmuNumber
00018c  7829              LDRB     r1,[r5,#0]            ;1201  ; StackCountForIni
00018e  4288              CMP      r0,r1                 ;1201
000190  d104              BNE      |L1.412|
000192  f7fffffe          BL       apiSysParGetBmuNumber
000196  7869              LDRB     r1,[r5,#1]            ;1202  ; StackCountForIni
000198  4288              CMP      r0,r1                 ;1202
00019a  d002              BEQ      |L1.418|
                  |L1.412|
00019c  f7fffffe          BL       changeToBq796xxIniHandler
0001a0  e7c2              B        |L1.296|
                  |L1.418|
0001a2  f7fffffe          BL       apiSysParGetBmuNumber
0001a6  7829              LDRB     r1,[r5,#0]            ;1209  ; StackCountForIni
0001a8  4288              CMP      r0,r1                 ;1209
0001aa  d004              BEQ      |L1.438|
0001ac  f7fffffe          BL       apiSysParGetBmuNumber
0001b0  7869              LDRB     r1,[r5,#1]            ;1210  ; StackCountForIni
0001b2  4288              CMP      r0,r1                 ;1210
0001b4  d101              BNE      |L1.442|
                  |L1.438|
0001b6  853c              STRH     r4,[r7,#0x28]         ;1212
0001b8  e001              B        |L1.446|
                  |L1.442|
0001ba  2019              MOVS     r0,#0x19              ;1216
0001bc  8538              STRH     r0,[r7,#0x28]         ;1216
                  |L1.446|
0001be  4826              LDR      r0,|L1.600|
0001c0  62f8              STR      r0,[r7,#0x2c]         ;1218  ; AfeTimerHandlerProcessor
0001c2  633e              STR      r6,[r7,#0x30]         ;1219  ; AfeFunctionProcessor
0001c4  843e              STRH     r6,[r7,#0x20]         ;1220
0001c6  72be              STRB     r6,[r7,#0xa]          ;1222
0001c8  e7ae              B        |L1.296|
                  |L1.458|
0001ca  f7fffffe          BL       apiSysParGetBmuNumber
0001ce  7a39              LDRB     r1,[r7,#8]            ;1226  ; BridgeDirection
0001d0  5c6a              LDRB     r2,[r5,r1]            ;1226
0001d2  4290              CMP      r0,r2                 ;1226
0001d4  d101              BNE      |L1.474|
0001d6  2005              MOVS     r0,#5                 ;1228
0001d8  7278              STRB     r0,[r7,#9]            ;1228
                  |L1.474|
0001da  703e              STRB     r6,[r7,#0]            ;1231
0001dc  83fc              STRH     r4,[r7,#0x1e]         ;1232
0001de  7a78              LDRB     r0,[r7,#9]            ;1233  ; BridgeSwitchCount
0001e0  1c40              ADDS     r0,r0,#1              ;1233
0001e2  b2c0              UXTB     r0,r0                 ;1233
0001e4  7278              STRB     r0,[r7,#9]            ;1233
0001e6  2805              CMP      r0,#5                 ;1234
0001e8  d39e              BCC      |L1.296|
0001ea  727e              STRB     r6,[r7,#9]            ;1236
0001ec  b189              CBZ      r1,|L1.530|
0001ee  7af8              LDRB     r0,[r7,#0xb]          ;1240  ; NorthAndSouthIniFlag
0001f0  f0400002          ORR      r0,r0,#2              ;1240
0001f4  72f8              STRB     r0,[r7,#0xb]          ;1240
                  |L1.502|
0001f6  f0810201          EOR      r2,r1,#1              ;1241
0001fa  723a              STRB     r2,[r7,#8]            ;1241
0001fc  f8d80000          LDR      r0,[r8,#0]            ;1241
000200  f4805000          EOR      r0,r0,#0x2000         ;1241
000204  f8c80000          STR      r0,[r8,#0]            ;1241
000208  a114              ADR      r1,|L1.604|
00020a  a802              ADD      r0,sp,#8              ;1243
00020c  f7fffffe          BL       __2sprintf
000210  e78a              B        |L1.296|
                  |L1.530|
000212  7af8              LDRB     r0,[r7,#0xb]          ;1238  ; NorthAndSouthIniFlag
000214  f0400001          ORR      r0,r0,#1              ;1238
000218  72f8              STRB     r0,[r7,#0xb]          ;1238
00021a  e7ec              B        |L1.502|
                  |L1.540|
00021c  1e40              SUBS     r0,r0,#1              ;1250
00021e  83f8              STRH     r0,[r7,#0x1e]         ;1250
000220  e782              B        |L1.296|
;;;1253   
                          ENDP

000222  0000              DCW      0x0000
                  |L1.548|
                          DCD      0x48000c14
                  |L1.552|
                          DCD      ||.data||
                  |L1.556|
00022c  57616b65          DCB      "Wakeup: %d",0
000230  75703a20
000234  256400  
000237  00                DCB      0
                  |L1.568|
000238  536f7574          DCB      "South Number:%d",0
00023c  68204e75
000240  6d626572
000244  3a256400
                  |L1.584|
000248  4e6f7274          DCB      "North Number:%d",0
00024c  68204e75
000250  6d626572
000254  3a256400
                  |L1.600|
                          DCD      AfeBq796xxNormalHandler
                  |L1.604|
00025c  496e6920          DCB      "Ini Dir = %d",0
000260  44697220
000264  3d202564
000268  00      
000269  00                DCB      0
00026a  00                DCB      0
00026b  00                DCB      0

                          AREA ||i.AfeBq796xxNormalHandler||, CODE, READONLY, ALIGN=2

                  AfeBq796xxNormalHandler PROC
;;;1035   
;;;1036   static void AfeBq796xxNormalHandler(uint16_t evt)
000000  4a0d              LDR      r2,|L2.56|
;;;1037   {
;;;1038   //	static uint16_t test_gpio_HL=0;
;;;1039   //	uint8_t res, res_c=0;
;;;1040   	static uint8_t	count;
;;;1041   	//static uint8_t	static;
;;;1042   //	uint8_t	state;
;;;1043   	//GPIOD->ODR |= GPIO_PIN_14;
;;;1044    
;;;1045       if(evt == LIB_SW_TIMER_EVT_SW_1MS)
000002  280a              CMP      r0,#0xa
000004  6b11              LDR      r1,[r2,#0x30]
000006  d013              BEQ      |L2.48|
;;;1046       {
;;;1047       	if(AfeFunctionProcessor)
;;;1048   			AfeFunctionProcessor();
;;;1049   		//GPIOC->ODR ^= GPIO_PIN_6;
;;;1050   	}
;;;1051   	else if(evt == LIB_SW_TIMER_EVT_SW_10MS_9)
000008  2809              CMP      r0,#9
00000a  d110              BNE      |L2.46|
;;;1052   	{
;;;1053       	count++;
00000c  7dd0              LDRB     r0,[r2,#0x17]  ; count
00000e  1c40              ADDS     r0,r0,#1
000010  b2c0              UXTB     r0,r0
000012  75d0              STRB     r0,[r2,#0x17]
;;;1054      		AfeFailTimerCount++;
000014  8c13              LDRH     r3,[r2,#0x20]  ; AfeFailTimerCount
000016  1c5b              ADDS     r3,r3,#1
000018  8413              STRH     r3,[r2,#0x20]
;;;1055   		//if(AfeFailTimerCount >= 200)	//time out
;;;1056   		if(0)
;;;1057   		{
;;;1058   			AfeState = AFE_STATE_INI;
;;;1059   
;;;1060   			//afe_steps = AFE_INIT_IDLE;
;;;1061   			//cnt_delay = 0;
;;;1062   			changeToBq796xxIniHandler();
;;;1063   			//AfeTimerHandlerProcessor = AfeBq796xxIniHandler;
;;;1064   			AfeFailTimerCount = 0;
;;;1065   		}
;;;1066   		else if(count  >= ReaAfeCycleCount10Ms)
00001a  8d13              LDRH     r3,[r2,#0x28]  ; ReaAfeCycleCount10Ms
00001c  4298              CMP      r0,r3
00001e  d306              BCC      |L2.46|
;;;1067   		{
;;;1068   			count = 0;
000020  2000              MOVS     r0,#0
000022  75d0              STRB     r0,[r2,#0x17]
;;;1069   			if(!AfeFunctionProcessor)
000024  2900              CMP      r1,#0
000026  d102              BNE      |L2.46|
;;;1070   			{
;;;1071   				halAfeBq796xxDebugMsg("Start read AFE");
;;;1072   				MainFunIndex = 0;
000028  7310              STRB     r0,[r2,#0xc]
;;;1073   				AfeFunctionProcessor = afeMainFunctionTable[0];
00002a  4804              LDR      r0,|L2.60|
00002c  6310              STR      r0,[r2,#0x30]  ; AfeFunctionProcessor
                  |L2.46|
;;;1074   			}
;;;1075   		}
;;;1076   	}
;;;1077   	//GPIOD->ODR &= ~GPIO_PIN_14;
;;;1078   }
00002e  4770              BX       lr
                  |L2.48|
000030  2900              CMP      r1,#0                 ;1047
000032  d0fc              BEQ      |L2.46|
000034  4708              BX       r1                    ;1048
;;;1079   
                          ENDP

000036  0000              DCW      0x0000
                  |L2.56|
                          DCD      ||.data||
                  |L2.60|
                          DCD      mainFunStopBalance

                          AREA ||i.CvtCellAdcToMv||, CODE, READONLY, ALIGN=2

                  CvtCellAdcToMv PROC
;;;604    
;;;605    uint16_t CvtCellAdcToMv(uint16_t adc)
000000  b510              PUSH     {r4,lr}
;;;606    {
;;;607    	double	d;
;;;608    	d = adc;
000002  f7fffffe          BL       __aeabi_ui2d
000006  ec410b10          VMOV     d0,r0,r1
;;;609    	d *= BQ79656_RESOLUTION_CELL_MAIN;
00000a  ed9f1b08          VLDR     d1,|L3.44|
00000e  ec510b10          VMOV     r0,r1,d0
000012  ec532b11          VMOV     r2,r3,d1
000016  f7fffffe          BL       __aeabi_dmul
00001a  ec410b10          VMOV     d0,r0,r1
;;;610    	return (uint16_t) d;	
00001e  ec510b10          VMOV     r0,r1,d0
000022  f7fffffe          BL       __aeabi_d2uiz
000026  b280              UXTH     r0,r0
;;;611    }
000028  bd10              POP      {r4,pc}
;;;612    uint16_t CvtNtcAdcToMv(uint16_t adc)
                          ENDP

00002a  0000              DCW      0x0000
                  |L3.44|
00002c  40000000          DCFD     0x3fc869d740000000 ; 0.19073000550270081
000030  3fc869d7

                          AREA ||i.CvtNtcAdcToMv||, CODE, READONLY, ALIGN=2

                  CvtNtcAdcToMv PROC
;;;611    }
;;;612    uint16_t CvtNtcAdcToMv(uint16_t adc)
000000  b510              PUSH     {r4,lr}
;;;613    {
;;;614    	double	d;
;;;615    	d = adc;
000002  f7fffffe          BL       __aeabi_ui2d
000006  ec410b10          VMOV     d0,r0,r1
;;;616    	d *= BQ79656_RESOLUTION_GPIO;
00000a  ed9f1b08          VLDR     d1,|L4.44|
00000e  ec510b10          VMOV     r0,r1,d0
000012  ec532b11          VMOV     r2,r3,d1
000016  f7fffffe          BL       __aeabi_dmul
00001a  ec410b10          VMOV     d0,r0,r1
;;;617    	return (uint16_t) d;	
00001e  ec510b10          VMOV     r0,r1,d0
000022  f7fffffe          BL       __aeabi_d2uiz
000026  b280              UXTH     r0,r0
;;;618    }
000028  bd10              POP      {r4,pc}
;;;619    
                          ENDP

00002a  0000              DCW      0x0000
                  |L4.44|
00002c  c0000000          DCFD     0x3fc38811c0000000 ; 0.15259000658988953
000030  3fc38811

                          AREA ||i.DecodeCellVoltageByCellFlag||, CODE, READONLY, ALIGN=1

                  DecodeCellVoltageByCellFlag PROC
;;;619    
;;;620    static void DecodeCellVoltageByCellFlag(bq796xx_data_t *bq_data)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;621    {
000004  4680              MOV      r8,r0
;;;622    	uint8_t		BmuIndex;
;;;623    	uint8_t		CellChannel;
;;;624    	uint32_t	CellFlag;
;;;625    	uint16_t	LogicCellIndex = 0;
000006  2700              MOVS     r7,#0
;;;626    	uint16_t	adc;
;;;627    	uint16_t	voltage;
;;;628    	uint8_t		paser_id;
;;;629    	
;;;630    	if(bq_data->paser_id == 0)
000008  f8980d8a          LDRB     r0,[r8,#0xd8a]
00000c  2800              CMP      r0,#0
00000e  d02e              BEQ      |L5.110|
;;;631    		return;
;;;632    	if(appProjectIsInSimuMode())
000010  f7fffffe          BL       appProjectIsInSimuMode
000014  2800              CMP      r0,#0
000016  d12a              BNE      |L5.110|
;;;633    		return;
;;;634    
;;;635    	paser_id = bq_data->paser_id -1;
000018  f8980d8a          LDRB     r0,[r8,#0xd8a]
00001c  1e40              SUBS     r0,r0,#1
00001e  f0000aff          AND      r10,r0,#0xff
;;;636    	
;;;637    	for(BmuIndex=0; BmuIndex<afeBmuNumber(); BmuIndex++)
000022  2400              MOVS     r4,#0
000024  e01f              B        |L5.102|
                  |L5.38|
;;;638    	{
;;;639    		if(BmuIndex > bq_data->paser_id)
000026  f8980d8a          LDRB     r0,[r8,#0xd8a]
00002a  42a0              CMP      r0,r4
00002c  d31f              BCC      |L5.110|
;;;640    			break;
;;;641    			
;;;642    		CellFlag = apiSysParGetCellFlag(BmuIndex);
00002e  4620              MOV      r0,r4
000030  f7fffffe          BL       apiSysParGetCellFlag
000034  4606              MOV      r6,r0
;;;643    		for(CellChannel=0; CellChannel<16; CellChannel++)
000036  2500              MOVS     r5,#0
;;;644    		{
;;;645    			if(CellFlag & 0x01)
;;;646    			{
;;;647    				if(BmuIndex == paser_id)
;;;648    				{
;;;649    					adc = bq_data->vcell_data[BmuIndex][CellChannel];
000038  eb081944          ADD      r9,r8,r4,LSL #5
                  |L5.60|
00003c  07f0              LSLS     r0,r6,#31             ;645
00003e  d00b              BEQ      |L5.88|
000040  4554              CMP      r4,r10                ;647
000042  d107              BNE      |L5.84|
000044  f8390015          LDRH     r0,[r9,r5,LSL #1]
;;;650    					voltage = CvtCellAdcToMv(adc);
000048  f7fffffe          BL       CvtCellAdcToMv
00004c  4601              MOV      r1,r0
;;;651    					halAfeSetCellVoltage(LogicCellIndex, voltage);
00004e  4638              MOV      r0,r7
000050  f7fffffe          BL       halAfeSetCellVoltage
                  |L5.84|
;;;652    				}
;;;653    				LogicCellIndex++;
000054  1c7f              ADDS     r7,r7,#1
000056  b2bf              UXTH     r7,r7
                  |L5.88|
;;;654    			}
;;;655    			CellFlag >>= 1;
000058  0876              LSRS     r6,r6,#1
00005a  1c6d              ADDS     r5,r5,#1              ;643
00005c  b2ed              UXTB     r5,r5                 ;643
00005e  2d10              CMP      r5,#0x10              ;643
000060  d3ec              BCC      |L5.60|
000062  1c64              ADDS     r4,r4,#1              ;637
000064  b2e4              UXTB     r4,r4                 ;637
                  |L5.102|
000066  f7fffffe          BL       apiSysParGetBmuNumber
00006a  42a0              CMP      r0,r4                 ;637
00006c  d8db              BHI      |L5.38|
                  |L5.110|
;;;656    		}
;;;657    	}
;;;658    }
00006e  e8bd87f0          POP      {r4-r10,pc}
;;;659    static void DecodeNtcVoltageByNtcFlag(bq796xx_data_t *bq_data,uint8_t NtcDataChannel)
                          ENDP


                          AREA ||i.DecodeNtcVoltageByNtcFlag||, CODE, READONLY, ALIGN=2

                  DecodeNtcVoltageByNtcFlag PROC
;;;658    }
;;;659    static void DecodeNtcVoltageByNtcFlag(bq796xx_data_t *bq_data,uint8_t NtcDataChannel)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;660    {
000004  4605              MOV      r5,r0
000006  460c              MOV      r4,r1
;;;661    	uint8_t		BmuIndex;
;;;662    	static uint8_t		NtcChannel;
;;;663    	uint32_t	NtcFlag;
;;;664    	uint16_t	LogicNtcIndex = 0;
000008  2600              MOVS     r6,#0
;;;665    	uint16_t	adc;
;;;666    	uint16_t	voltage;
;;;667    	uint16_t	mask;
;;;668    	uint16_t	MaskChk;
;;;669    	uint8_t		paser_id;
;;;670    	char	str[100];
;;;671    	
;;;672    	if(bq_data->paser_id == 0)
00000a  f8950d8a          LDRB     r0,[r5,#0xd8a]
00000e  2800              CMP      r0,#0
000010  d03f              BEQ      |L6.146|
;;;673    		return;
;;;674    	if(appProjectIsInSimuMode())
000012  f7fffffe          BL       appProjectIsInSimuMode
000016  2800              CMP      r0,#0
000018  d13b              BNE      |L6.146|
;;;675    		return;
;;;676    		
;;;677    	paser_id = bq_data->paser_id -1;
00001a  f8950d8a          LDRB     r0,[r5,#0xd8a]
00001e  1e40              SUBS     r0,r0,#1
000020  f0000aff          AND      r10,r0,#0xff
;;;678    	mask = 1 << NtcDataChannel;
000024  f04f0b01          MOV      r11,#1
000028  fa0bf004          LSL      r0,r11,r4
00002c  fa1ff980          UXTH     r9,r0
;;;679    	for(BmuIndex=0; BmuIndex<afeBmuNumber(); BmuIndex++)
000030  2400              MOVS     r4,#0
;;;680    	{
;;;681    		if(BmuIndex > bq_data->paser_id)
;;;682    			break;
;;;683    		
;;;684    		NtcFlag = apiSysParGetNtcFlag(BmuIndex);
;;;685    		for(NtcChannel=0; NtcChannel<16; NtcChannel++)
000032  4f19              LDR      r7,|L6.152|
000034  e029              B        |L6.138|
                  |L6.54|
000036  f8950d8a          LDRB     r0,[r5,#0xd8a]        ;681
00003a  42a0              CMP      r0,r4                 ;681
00003c  d329              BCC      |L6.146|
00003e  4620              MOV      r0,r4                 ;684
000040  f7fffffe          BL       apiSysParGetNtcFlag
000044  4680              MOV      r8,r0                 ;684
000046  2000              MOVS     r0,#0
000048  74f8              STRB     r0,[r7,#0x13]
                  |L6.74|
;;;686    		{
;;;687    			MaskChk = 1 << NtcChannel;
00004a  7cf8              LDRB     r0,[r7,#0x13]  ; NtcChannel
00004c  fa0bf000          LSL      r0,r11,r0
000050  b280              UXTH     r0,r0
;;;688    			if(NtcFlag & MaskChk)
000052  ea180f00          TST      r8,r0
000056  d010              BEQ      |L6.122|
;;;689    			{				
;;;690    				if(BmuIndex == paser_id && (MaskChk & mask))
000058  4554              CMP      r4,r10
00005a  d10c              BNE      |L6.118|
00005c  ea100f09          TST      r0,r9
000060  d009              BEQ      |L6.118|
;;;691    				{
;;;692    					adc = bq_data->gpio_data[BmuIndex][0];
000062  eb051004          ADD      r0,r5,r4,LSL #4
000066  f8b007e0          LDRH     r0,[r0,#0x7e0]
;;;693    					voltage = CvtNtcAdcToMv(adc);
00006a  f7fffffe          BL       CvtNtcAdcToMv
00006e  4601              MOV      r1,r0
;;;694    					halAfeSetNtcAdcData(LogicNtcIndex, voltage);
000070  4630              MOV      r0,r6
000072  f7fffffe          BL       halAfeSetNtcAdcData
                  |L6.118|
;;;695    				}
;;;696    				LogicNtcIndex++;
000076  1c76              ADDS     r6,r6,#1
000078  b2b6              UXTH     r6,r6
                  |L6.122|
00007a  7cf8              LDRB     r0,[r7,#0x13]         ;685  ; NtcChannel
00007c  1c40              ADDS     r0,r0,#1              ;685
00007e  b2c0              UXTB     r0,r0                 ;685
000080  74f8              STRB     r0,[r7,#0x13]         ;685
000082  2810              CMP      r0,#0x10              ;685
000084  d3e1              BCC      |L6.74|
000086  1c64              ADDS     r4,r4,#1              ;679
000088  b2e4              UXTB     r4,r4                 ;679
                  |L6.138|
00008a  f7fffffe          BL       apiSysParGetBmuNumber
00008e  42a0              CMP      r0,r4                 ;679
000090  d8d1              BHI      |L6.54|
                  |L6.146|
;;;697    			}
;;;698    		}
;;;699    	}
;;;700    }
000092  e8bd9ff0          POP      {r4-r12,pc}
;;;701    
                          ENDP

000096  0000              DCW      0x0000
                  |L6.152|
                          DCD      ||.data||

                          AREA ||i.afeSwTimerHandler||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  afeSwTimerHandler PROC
;;;1253   
;;;1254   static void afeSwTimerHandler(__far void *dest, uint16_t evt, void *vDataPtr)
000000  b530              PUSH     {r4,r5,lr}
;;;1255   {
000002  b099              SUB      sp,sp,#0x64
000004  460d              MOV      r5,r1
;;;1256   	char	str[100];
;;;1257   	if(evt == LIB_SW_TIMER_EVT_SW_1S)
;;;1258   	{
;;;1259   		if(appProjectIsInSimuMode())
;;;1260   			AfeCommTimeOutCount  = 0;
000006  4c27              LDR      r4,|L7.164|
000008  2d0d              CMP      r5,#0xd               ;1257
00000a  d146              BNE      |L7.154|
00000c  f7fffffe          BL       appProjectIsInSimuMode
000010  b108              CBZ      r0,|L7.22|
000012  2000              MOVS     r0,#0
000014  70e0              STRB     r0,[r4,#3]
                  |L7.22|
;;;1261   		if(AfeCommTimeOutCount<200)
000016  78e2              LDRB     r2,[r4,#3]  ; AfeCommTimeOutCount
000018  2ac8              CMP      r2,#0xc8
00001a  d201              BCS      |L7.32|
;;;1262   			AfeCommTimeOutCount++;
00001c  1c52              ADDS     r2,r2,#1
00001e  70e2              STRB     r2,[r4,#3]
                  |L7.32|
;;;1263   		if(AfeCommTimeOutCount >= afeCommL1Time())
000020  78e0              LDRB     r0,[r4,#3]  ; AfeCommTimeOutCount
000022  2805              CMP      r0,#5
000024  d30c              BCC      |L7.64|
;;;1264   		{
;;;1265   			 if((AfeCommFlag & AFE_COMM_FLAG_L1) == 0)
000026  7922              LDRB     r2,[r4,#4]  ; AfeCommFlag
000028  07d0              LSLS     r0,r2,#31
00002a  d115              BNE      |L7.88|
;;;1266   			 {
;;;1267   			 	AfeCommFlag |= AFE_COMM_FLAG_L1;
00002c  f0420001          ORR      r0,r2,#1
000030  7120              STRB     r0,[r4,#4]
;;;1268   			 	if(afeEvtHandler)
000032  6b63              LDR      r3,[r4,#0x34]  ; afeEvtHandler
000034  b183              CBZ      r3,|L7.88|
;;;1269   			 		afeEvtHandler(0, AFE_EVT_COMM_L1_SET, 0);
000036  2200              MOVS     r2,#0
000038  2101              MOVS     r1,#1
00003a  4610              MOV      r0,r2
00003c  4798              BLX      r3
00003e  e00b              B        |L7.88|
                  |L7.64|
;;;1270   			 }
;;;1271   		}
;;;1272   		else
;;;1273   		{
;;;1274   			if((AfeCommFlag & AFE_COMM_FLAG_L1) != 0 )
000040  7920              LDRB     r0,[r4,#4]  ; AfeCommFlag
000042  07c1              LSLS     r1,r0,#31
000044  d008              BEQ      |L7.88|
;;;1275   			{
;;;1276   			 	AfeCommFlag &= ~AFE_COMM_FLAG_L1;
000046  f0200001          BIC      r0,r0,#1
00004a  7120              STRB     r0,[r4,#4]
;;;1277   			 	if(afeEvtHandler)
00004c  6b63              LDR      r3,[r4,#0x34]  ; afeEvtHandler
00004e  b11b              CBZ      r3,|L7.88|
;;;1278   			 		afeEvtHandler(0, AFE_EVT_COMM_L1_RELEASE, 0);
000050  2200              MOVS     r2,#0
000052  2102              MOVS     r1,#2
000054  4610              MOV      r0,r2
000056  4798              BLX      r3
                  |L7.88|
;;;1279   			}
;;;1280   		}
;;;1281   		if(AfeCommTimeOutCount >= afeCommL2Time())
000058  78e0              LDRB     r0,[r4,#3]  ; AfeCommTimeOutCount
00005a  2814              CMP      r0,#0x14
00005c  d30c              BCC      |L7.120|
;;;1282   		{
;;;1283   			if((AfeCommFlag & AFE_COMM_FLAG_L2) == 0)
00005e  7920              LDRB     r0,[r4,#4]  ; AfeCommFlag
000060  0781              LSLS     r1,r0,#30
000062  d415              BMI      |L7.144|
;;;1284   			{
;;;1285   			 	AfeCommFlag |= AFE_COMM_FLAG_L2;
000064  f0400002          ORR      r0,r0,#2
000068  7120              STRB     r0,[r4,#4]
;;;1286   			 	if(afeEvtHandler)
00006a  6b63              LDR      r3,[r4,#0x34]  ; afeEvtHandler
00006c  b183              CBZ      r3,|L7.144|
;;;1287   			 		afeEvtHandler(0, AFE_EVT_COMM_L2_SET, 0);
00006e  2200              MOVS     r2,#0
000070  2103              MOVS     r1,#3
000072  4610              MOV      r0,r2
000074  4798              BLX      r3
000076  e00b              B        |L7.144|
                  |L7.120|
;;;1288   			}
;;;1289   		}
;;;1290   		else
;;;1291   		{
;;;1292   			if((AfeCommFlag & AFE_COMM_FLAG_L2) != 0)
000078  7920              LDRB     r0,[r4,#4]  ; AfeCommFlag
00007a  0781              LSLS     r1,r0,#30
00007c  d508              BPL      |L7.144|
;;;1293   			{
;;;1294   			 	AfeCommFlag &= ~AFE_COMM_FLAG_L2;
00007e  f0200002          BIC      r0,r0,#2
000082  7120              STRB     r0,[r4,#4]
;;;1295   			 	if(afeEvtHandler)
000084  6b63              LDR      r3,[r4,#0x34]  ; afeEvtHandler
000086  b11b              CBZ      r3,|L7.144|
;;;1296   			 		afeEvtHandler(0, AFE_EVT_COMM_L2_RELEASE, 0);
000088  2200              MOVS     r2,#0
00008a  2104              MOVS     r1,#4
00008c  4610              MOV      r0,r2
00008e  4798              BLX      r3
                  |L7.144|
;;;1297   			}
;;;1298   		}
;;;1299   		sprintf(str,"Afe IDLE TIME : %d", AfeCommTimeOutCount);
000090  78e2              LDRB     r2,[r4,#3]  ; AfeCommTimeOutCount
000092  a105              ADR      r1,|L7.168|
000094  4668              MOV      r0,sp
000096  f7fffffe          BL       __2sprintf
                  |L7.154|
;;;1300   		halAfeBq796xxDebugMsg(str);
;;;1301   	}
;;;1302   	
;;;1303   //	GPIOD->ODR |= GPIO_PIN_15;	//over 1ms per 15ms 
;;;1304   	AfeTimerHandlerProcessor(evt);
00009a  6ae1              LDR      r1,[r4,#0x2c]  ; AfeTimerHandlerProcessor
00009c  4628              MOV      r0,r5
00009e  4788              BLX      r1
;;;1305   //	GPIOD->ODR &= ~GPIO_PIN_15;
;;;1306   }
0000a0  b019              ADD      sp,sp,#0x64
0000a2  bd30              POP      {r4,r5,pc}
;;;1307   #define	HW_2ND_PROTECT_PAR_INDEX	0x10	
                          ENDP

                  |L7.164|
                          DCD      ||.data||
                  |L7.168|
0000a8  41666520          DCB      "Afe IDLE TIME : %d",0
0000ac  49444c45
0000b0  2054494d
0000b4  45203a20
0000b8  256400  
0000bb  00                DCB      0

                          AREA ||i.app_afe_cb||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_widthprec
                          REQUIRE _printf_x
                          REQUIRE _printf_longlong_hex
                  app_afe_cb PROC
;;;701    
;;;702    uint8_t app_afe_cb(bq796xx_data_t *bq_data, bq796xx_event_cb_type bq_event){
000000  b500              PUSH     {lr}
000002  b09b              SUB      sp,sp,#0x6c
;;;703    
;;;704    //	static bq796xx_event_cb_type temp;
;;;705    //  	static bq796xx_data_t temp_afe_data;
;;;706    //	static uint8_t bq_event_buf[256]={0};
;;;707    //	static uint8_t bq_event_buf_c = 0;
;;;708    	char	str[100];
;;;709    //	uint8_t		temp_ch;
;;;710    
;;;711    //	halAfeBq796xxDebugMsg("Bq796xx CB");
;;;712    
;;;713     	switch(bq_event)
000004  2905              CMP      r1,#5
000006  d232              BCS      |L8.110|
000008  e8dff001          TBB      [pc,r1]
00000c  03060b14          DCB      0x03,0x06,0x0b,0x14
000010  2300              DCB      0x23,0x00
;;;714     	{
;;;715     	case BQ_EVENT_VCELL:
;;;716    		//halAfeBq796xxDebugMsg("Bq796xx CB VCell");
;;;717    		DecodeCellVoltageByCellFlag(bq_data);
000012  f7fffffe          BL       DecodeCellVoltageByCellFlag
;;;718    		break;
000016  e02a              B        |L8.110|
;;;719     	case BQ_EVENT_GPIO_ADC:
;;;720     		//halAfeBq796xxDebugMsg("Gpio");
;;;721     		DecodeNtcVoltageByNtcFlag(bq_data, NtcChannelSelect);
000018  4916              LDR      r1,|L8.116|
00001a  7c49              LDRB     r1,[r1,#0x11]  ; NtcChannelSelect
00001c  f7fffffe          BL       DecodeNtcVoltageByNtcFlag
;;;722    // 	          bq796xx_data.gpio_data[device_id-1][i]=bq796xx_res_buf[BQ796XX_DF_REG_PAYLOAD+(i*2)] * 256.0f + bq796xx_res_buf[BQ796XX_DF_REG_PAYLOAD+(i*2+1)];
;;;723    //
;;;724    // 		temp_ch = AfeFunctionStep - 1;
;;;725    // 		temp_ch &= 0x0f;
;;;726    // 		sprintf(str,"
;;;727    //		halAfeBq796xxDebugMsg("Bq796xx CB Gpio");
;;;728    		break;
000020  e025              B        |L8.110|
;;;729     	case BQ_EVENT_FAULT:
;;;730     		sprintf(str,"Fault Flag = %.4X %.4X", 
000022  f8903bd1          LDRB     r3,[r0,#0xbd1]
000026  f8902bd0          LDRB     r2,[r0,#0xbd0]
00002a  a113              ADR      r1,|L8.120|
00002c  a802              ADD      r0,sp,#8
00002e  f7fffffe          BL       __2sprintf
;;;731     				bq_data->fault_summary[0],
;;;732     				bq_data->fault_summary[1]);
;;;733    		//halAfeBq796xxDebugMsg(str);
;;;734    //		halAfeBq796xxDebugMsg("Bq796xx CB Fault");
;;;735    		break;
000032  e01c              B        |L8.110|
;;;736     	case BQ_EVENT_FAULTOVUV:
;;;737      		sprintf(str,"OV UP Flag = %.4X %.4X %.4X %.4X", 
000034  f8b01c90          LDRH     r1,[r0,#0xc90]
000038  f8b02c12          LDRH     r2,[r0,#0xc12]
00003c  e9cd2100          STRD     r2,r1,[sp,#0]
000040  f8b03c8e          LDRH     r3,[r0,#0xc8e]
000044  f8b02c10          LDRH     r2,[r0,#0xc10]
000048  a111              ADR      r1,|L8.144|
00004a  a802              ADD      r0,sp,#8
00004c  f7fffffe          BL       __2sprintf
;;;738     				bq_data->fault_ov[0],
;;;739     				bq_data->fault_uv[0],
;;;740     				bq_data->fault_ov[1],
;;;741     				bq_data->fault_uv[1]);
;;;742     		//halAfeBq796xxDebugMsg(str);
;;;743    		break;
000050  e00d              B        |L8.110|
;;;744     	case BQ_EVENT_FAULTOTUT:
;;;745      		sprintf(str,"OT UT Flag = %.4X %.4X %.4X %.4X", 
000052  f8901d4c          LDRB     r1,[r0,#0xd4c]
000056  f8902d0d          LDRB     r2,[r0,#0xd0d]
00005a  e9cd2100          STRD     r2,r1,[sp,#0]
00005e  f8903d4b          LDRB     r3,[r0,#0xd4b]
000062  f8902d0c          LDRB     r2,[r0,#0xd0c]
000066  a113              ADR      r1,|L8.180|
000068  a802              ADD      r0,sp,#8
00006a  f7fffffe          BL       __2sprintf
                  |L8.110|
;;;746     				bq_data->fault_ot[0],
;;;747     				bq_data->fault_ut[0],
;;;748     				bq_data->fault_ot[1],
;;;749     				bq_data->fault_ut[1]);
;;;750     		//halAfeBq796xxDebugMsg(str);
;;;751    		break;
;;;752     	case BQ_EVENT_OTHER_ERR:
;;;753    		//halAfeBq796xxDebugMsg("Bq796xx CB Other");
;;;754    		break;
;;;755    	default:
;;;756    		//halAfeBq796xxDebugMsg("Bq796xx CB Undefine");
;;;757    		break;
;;;758    	}	 
;;;759    	 
;;;760    //	temp = bq_event;
;;;761    //	temp_afe_data = *bq_data;
;;;762    	
;;;763    //	bq_event_buf[ bq_event_buf_c++ ] = temp;
;;;764    //	if(bq_event_buf_c > 255) 
;;;765    //		bq_event_buf_c=0;
;;;766    	
;;;767    	return 0;
;;;768    }
00006e  b01b              ADD      sp,sp,#0x6c
000070  2000              MOVS     r0,#0                 ;767
000072  bd00              POP      {pc}
;;;769    
                          ENDP

                  |L8.116|
                          DCD      ||.data||
                  |L8.120|
000078  4661756c          DCB      "Fault Flag = %.4X %.4X",0
00007c  7420466c
000080  6167203d
000084  20252e34
000088  5820252e
00008c  345800  
00008f  00                DCB      0
                  |L8.144|
000090  4f562055          DCB      "OV UP Flag = %.4X %.4X %.4X %.4X",0
000094  5020466c
000098  6167203d
00009c  20252e34
0000a0  5820252e
0000a4  34582025
0000a8  2e345820
0000ac  252e3458
0000b0  00      
0000b1  00                DCB      0
0000b2  00                DCB      0
0000b3  00                DCB      0
                  |L8.180|
0000b4  4f542055          DCB      "OT UT Flag = %.4X %.4X %.4X %.4X",0
0000b8  5420466c
0000bc  6167203d
0000c0  20252e34
0000c4  5820252e
0000c8  34582025
0000cc  2e345820
0000d0  252e3458
0000d4  00      
0000d5  00                DCB      0
0000d6  00                DCB      0
0000d7  00                DCB      0

                          AREA ||i.changeBmuDirForDataReadProcessor||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  changeBmuDirForDataReadProcessor PROC
;;;898    
;;;899    static void changeBmuDirForDataReadProcessor(void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;900    {
000004  b09c              SUB      sp,sp,#0x70
;;;901    	static uint8_t	ChangeDirCount = 0;	
;;;902    	uint8_t	res;
;;;903    	char	str[100];
;;;904    	
;;;905    	if(cnt_delay >= 2)
000006  4d3b              LDR      r5,|L9.244|
000008  8be8              LDRH     r0,[r5,#0x1e]  ; cnt_delay
00000a  2802              CMP      r0,#2
00000c  d304              BCC      |L9.24|
;;;906    	{
;;;907    		cnt_delay--;
00000e  1e40              SUBS     r0,r0,#1
000010  b280              UXTH     r0,r0
000012  83e8              STRH     r0,[r5,#0x1e]
;;;908    		if(cnt_delay)
000014  2800              CMP      r0,#0
000016  d15d              BNE      |L9.212|
                  |L9.24|
;;;909    			return;
;;;910    	}
;;;911    	if(afe_steps == 0)
;;;912    	{
;;;913    		sprintf(str,"Dir = %d,初始化數量= %d", 
000018  f8df80d8          LDR      r8,|L9.244|
00001c  7828              LDRB     r0,[r5,#0]            ;911  ; afe_steps
;;;914    					BridgeDirection,
;;;915    					StackCountForIni[BridgeDirection]);
;;;916    		halAfeBq796xxDebugMsg(str);
;;;917    		GPIOD->ODR |= GPIO_PIN_14;
00001e  4f36              LDR      r7,|L9.248|
000020  f1080822          ADD      r8,r8,#0x22           ;913
000024  2600              MOVS     r6,#0                 ;913
000026  b9a0              CBNZ     r0,|L9.82|
000028  7a2a              LDRB     r2,[r5,#8]            ;913  ; BridgeDirection
00002a  a134              ADR      r1,|L9.252|
00002c  a803              ADD      r0,sp,#0xc            ;913
00002e  f8183002          LDRB     r3,[r8,r2]            ;913
000032  f7fffffe          BL       __2sprintf
000036  6838              LDR      r0,[r7,#0]
000038  f4404080          ORR      r0,r0,#0x4000
00003c  6038              STR      r0,[r7,#0]
;;;918    		ChangeDirCount++;
00003e  7da8              LDRB     r0,[r5,#0x16]  ; ChangeDirCount
000040  1c40              ADDS     r0,r0,#1
000042  b2c0              UXTB     r0,r0
000044  75a8              STRB     r0,[r5,#0x16]
;;;919    		if(ChangeDirCount >= 10)
000046  280a              CMP      r0,#0xa
000048  d303              BCC      |L9.82|
;;;920    		{
;;;921    			halAfeBq796xxDebugMsg(".........檢查是否接線正常");
;;;922    			StackCountForIni[BridgeDirection] = 0;
00004a  7a28              LDRB     r0,[r5,#8]  ; BridgeDirection
00004c  f8086000          STRB     r6,[r8,r0]
;;;923    			ChangeDirCount = 0;
000050  75ae              STRB     r6,[r5,#0x16]
                  |L9.82|
;;;924    		}
;;;925    	}
;;;926    	res = drv_bq796xx_direction_set_steps(StackCountForIni[BridgeDirection],  
000052  f7fffffe          BL       apiSysParGetBmuNumber
000056  1c40              ADDS     r0,r0,#1
000058  b2c2              UXTB     r2,r0
00005a  4826              LDR      r0,|L9.244|
00005c  1c80              ADDS     r0,r0,#2
00005e  1e41              SUBS     r1,r0,#1
000060  e9cd1000          STRD     r1,r0,[sp,#0]
000064  7a2b              LDRB     r3,[r5,#8]  ; BridgeDirection
000066  1e49              SUBS     r1,r1,#1
000068  f8180003          LDRB     r0,[r8,r3]
00006c  f7fffffe          BL       drv_bq796xx_direction_set_steps
;;;927    										  &afe_steps, 
;;;928    										  afeBmuNumber()+1 , 
;;;929    										  BridgeDirection, 
;;;930    										  &step_com_f , 
;;;931    										  &before_d_ms);
;;;932    	cnt_delay = before_d_ms;
000070  78a9              LDRB     r1,[r5,#2]  ; before_d_ms
000072  83e9              STRH     r1,[r5,#0x1e]
;;;933    	if(step_com_f == 1)
000074  7869              LDRB     r1,[r5,#1]  ; step_com_f
000076  2901              CMP      r1,#1
000078  d102              BNE      |L9.128|
;;;934    	{
;;;935    		afe_steps++;
00007a  7829              LDRB     r1,[r5,#0]  ; afe_steps
00007c  1c49              ADDS     r1,r1,#1
00007e  7029              STRB     r1,[r5,#0]
                  |L9.128|
;;;936    	}
;;;937    	if(afe_steps > SETDIR_AFE_RUN_AUX_ADC)
000080  7829              LDRB     r1,[r5,#0]  ; afe_steps
000082  2912              CMP      r1,#0x12
000084  d926              BLS      |L9.212|
;;;938    	{
;;;939    		if(res & 0x80)
000086  0601              LSLS     r1,r0,#24
000088  d502              BPL      |L9.144|
;;;940    		{
;;;941    			IsRingDaisyChain = 1;
00008a  2101              MOVS     r1,#1
00008c  76e9              STRB     r1,[r5,#0x1b]
00008e  e000              B        |L9.146|
                  |L9.144|
;;;942    			halAfeBq796xxDebugMsg("................Ring");
;;;943    		}
;;;944    		else
;;;945    		{
;;;946    			halAfeBq796xxDebugMsg("..........Not...Ring");
;;;947    			IsRingDaisyChain = 0;
000090  76ee              STRB     r6,[r5,#0x1b]
                  |L9.146|
;;;948    		}
;;;949    		res &= 0x7f;
000092  f000047f          AND      r4,r0,#0x7f
;;;950    				
;;;951    		GPIOD->ODR &= ~GPIO_PIN_14;
000096  6838              LDR      r0,[r7,#0]
000098  f4204080          BIC      r0,r0,#0x4000
00009c  6038              STR      r0,[r7,#0]
;;;952    		StackCountForIni[BridgeDirection] = res;
00009e  7a28              LDRB     r0,[r5,#8]  ; BridgeDirection
0000a0  f8084000          STRB     r4,[r8,r0]
;;;953    
;;;954    #ifdef AFE_DEBUG_MODE
;;;955    		StackCountForIni[DIR_NORTH] = AFE_DEBUG_N_NUM;
;;;956    		StackCountForIni[DIR_SOUTH] = AFE_DEBUG_S_NUM;
;;;957    		if(BridgeDirection == DIR_NORTH)
;;;958    			res = AFE_DEBUG_N_NUM;
;;;959    		else
;;;960    			res = AFE_DEBUG_S_NUM;
;;;961    #endif
;;;962    
;;;963    		if(BridgeDirection == DIR_NORTH)
0000a4  b168              CBZ      r0,|L9.194|
;;;964    			sprintf(str,"Get North BMU# = %d", res);
;;;965    		else
;;;966    			sprintf(str,"Get South BMU# = %d", res);
0000a6  4622              MOV      r2,r4
0000a8  a11a              ADR      r1,|L9.276|
0000aa  a803              ADD      r0,sp,#0xc
0000ac  f7fffffe          BL       __2sprintf
                  |L9.176|
;;;967    		halAfeBq796xxDebugMsg(str);
;;;968    		if((IsRingDaisyChain && res == afeBmuNumber()) ||
0000b0  7ee8              LDRB     r0,[r5,#0x1b]  ; IsRingDaisyChain
0000b2  b118              CBZ      r0,|L9.188|
0000b4  f7fffffe          BL       apiSysParGetBmuNumber
0000b8  42a0              CMP      r0,r4
0000ba  d009              BEQ      |L9.208|
                  |L9.188|
;;;969    		   (!IsRingDaisyChain && res))
0000bc  7ee8              LDRB     r0,[r5,#0x1b]  ; IsRingDaisyChain
0000be  b130              CBZ      r0,|L9.206|
0000c0  e00b              B        |L9.218|
                  |L9.194|
0000c2  4622              MOV      r2,r4                 ;964
0000c4  a118              ADR      r1,|L9.296|
0000c6  a803              ADD      r0,sp,#0xc            ;964
0000c8  f7fffffe          BL       __2sprintf
0000cc  e7f0              B        |L9.176|
                  |L9.206|
0000ce  b124              CBZ      r4,|L9.218|
                  |L9.208|
;;;970    		{
;;;971    			getNextSubFunctionPointer();
0000d0  f7fffffe          BL       getNextSubFunctionPointer
                  |L9.212|
;;;972    		}
;;;973    		else
;;;974    		{
;;;975    			halAfeBq796xxDebugMsg("重新切方向");
;;;976    			cnt_delay = 100;
;;;977    			afe_steps = 0;
;;;978    			CHANGE_BRIDGE_DIRECTION();
;;;979    		}
;;;980      	}
;;;981    }
0000d4  b01c              ADD      sp,sp,#0x70
0000d6  e8bd81f0          POP      {r4-r8,pc}
                  |L9.218|
0000da  2064              MOVS     r0,#0x64              ;976
0000dc  83e8              STRH     r0,[r5,#0x1e]         ;976
0000de  702e              STRB     r6,[r5,#0]            ;977
0000e0  7a28              LDRB     r0,[r5,#8]            ;978  ; BridgeDirection
0000e2  f0800001          EOR      r0,r0,#1              ;978
0000e6  7228              STRB     r0,[r5,#8]            ;978
0000e8  6838              LDR      r0,[r7,#0]            ;978
0000ea  f4805000          EOR      r0,r0,#0x2000         ;978
0000ee  6038              STR      r0,[r7,#0]            ;978
0000f0  e7f0              B        |L9.212|
;;;982    
                          ENDP

0000f2  0000              DCW      0x0000
                  |L9.244|
                          DCD      ||.data||
                  |L9.248|
                          DCD      0x48000c14
                  |L9.252|
0000fc  44697220          DCB      "Dir = %d,",170,236,169,"l",164,198,188,198,182,"q= %d",0
000100  3d202564
000104  2caaeca9
000108  6ca4c6bc
00010c  c6b6713d
000110  20256400
                  |L9.276|
000114  47657420          DCB      "Get South BMU# = %d",0
000118  536f7574
00011c  6820424d
000120  5523203d
000124  20256400
                  |L9.296|
000128  47657420          DCB      "Get North BMU# = %d",0
00012c  4e6f7274
000130  6820424d
000134  5523203d
000138  20256400

                          AREA ||i.changeDirIni||, CODE, READONLY, ALIGN=2

                  changeDirIni PROC
;;;771    
;;;772    static void changeDirIni(void)
000000  4802              LDR      r0,|L10.12|
;;;773    {
;;;774    	cnt_delay = 0;
000002  2100              MOVS     r1,#0
000004  83c1              STRH     r1,[r0,#0x1e]
;;;775    	afe_steps = AFE_INIT_IDLE;
000006  7001              STRB     r1,[r0,#0]
;;;776    }
000008  4770              BX       lr
;;;777    
                          ENDP

00000a  0000              DCW      0x0000
                  |L10.12|
                          DCD      ||.data||

                          AREA ||i.changeToBq796xxIniHandler||, CODE, READONLY, ALIGN=2

                  changeToBq796xxIniHandler PROC
;;;1082   
;;;1083   static void changeToBq796xxIniHandler(void)
000000  4805              LDR      r0,|L11.24|
;;;1084   {
;;;1085   	BridgeDirection = DIR_SOUTH;//DIR_SOUTH;//DIR_NORTH;
000002  2101              MOVS     r1,#1
000004  7201              STRB     r1,[r0,#8]
;;;1086   	BridgeSwitchCount =0;
000006  2200              MOVS     r2,#0
000008  7242              STRB     r2,[r0,#9]
;;;1087   	NorthAndSouthIniFlag = 0;
00000a  72c2              STRB     r2,[r0,#0xb]
;;;1088   	AfeState = AFE_STATE_INI;
00000c  7281              STRB     r1,[r0,#0xa]
;;;1089   	cnt_delay = 0;
00000e  83c2              STRH     r2,[r0,#0x1e]
;;;1090   	wake_sw = WAKE_TONE_ENABLE;
000010  7341              STRB     r1,[r0,#0xd]
;;;1091   	AfeTimerHandlerProcessor = AfeBq796xxIniHandler;
000012  4902              LDR      r1,|L11.28|
000014  62c1              STR      r1,[r0,#0x2c]  ; AfeTimerHandlerProcessor
;;;1092   }
000016  4770              BX       lr
;;;1093   static void AfeBq796xxIniHandler(uint16_t evt)
                          ENDP

                  |L11.24|
                          DCD      ||.data||
                  |L11.28|
                          DCD      AfeBq796xxIniHandler

                          AREA ||i.converterNtcVoltageToPercentage||, CODE, READONLY, ALIGN=1

                  converterNtcVoltageToPercentage PROC
;;;1357   }
;;;1358   uint8_t	converterNtcVoltageToPercentage(uint16_t voltage)
000000  2164              MOVS     r1,#0x64
;;;1359   {
;;;1360   	uint32_t	r;
;;;1361   	
;;;1362   	r = voltage;
;;;1363   	r *= 100;
000002  4348              MULS     r0,r1,r0
;;;1364   	r /= 5000;
000004  f2413188          MOV      r1,#0x1388
000008  fbb0f0f1          UDIV     r0,r0,r1
;;;1365   	return r;
00000c  b2c0              UXTB     r0,r0
;;;1366   }
00000e  4770              BX       lr
;;;1367   
                          ENDP


                          AREA ||i.delayFunction||, CODE, READONLY, ALIGN=2

                  delayFunction PROC
;;;224    }
;;;225    static void delayFunction(void)
000000  4905              LDR      r1,|L13.24|
;;;226    {
;;;227    	if(delayCount)
000002  7f08              LDRB     r0,[r1,#0x1c]  ; delayCount
000004  2800              CMP      r0,#0
000006  d001              BEQ      |L13.12|
;;;228    		delayCount--;
000008  1e40              SUBS     r0,r0,#1
00000a  7708              STRB     r0,[r1,#0x1c]
                  |L13.12|
;;;229    	if(!delayCount)
00000c  7f08              LDRB     r0,[r1,#0x1c]  ; delayCount
00000e  2800              CMP      r0,#0
000010  d101              BNE      |L13.22|
;;;230    		getNextSubFunctionPointer();
000012  f7ffbffe          B.W      getNextSubFunctionPointer
                  |L13.22|
;;;231    }
000016  4770              BX       lr
;;;232    
                          ENDP

                  |L13.24|
                          DCD      ||.data||

                          AREA ||i.finishAfeReadProcessor||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  finishAfeReadProcessor PROC
;;;777    
;;;778    static void finishAfeReadProcessor(void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;779    {
000004  b09c              SUB      sp,sp,#0x70
;;;780    	char	str[100];
;;;781    	static	uint8_t	fail_count = 0;
;;;782    	static  uint8_t	run_count = 0;
;;;783    	
;;;784    	sprintf(str,"finish afe read:Dir=%d Error:%d/%d Num=%d %d" , 
000006  4d35              LDR      r5,|L14.220|
000008  f1a50422          SUB      r4,r5,#0x22
00000c  7829              LDRB     r1,[r5,#0]  ; StackCountForIni
00000e  7868              LDRB     r0,[r5,#1]  ; StackCountForIni
000010  7d62              LDRB     r2,[r4,#0x15]  ; run_count
000012  e9cd2100          STRD     r2,r1,[sp,#0]
000016  9002              STR      r0,[sp,#8]
000018  7d23              LDRB     r3,[r4,#0x14]  ; fail_count
00001a  7a22              LDRB     r2,[r4,#8]  ; BridgeDirection
00001c  a130              ADR      r1,|L14.224|
00001e  a803              ADD      r0,sp,#0xc
000020  f7fffffe          BL       __2sprintf
;;;785    			BridgeDirection, fail_count, run_count,
;;;786    			StackCountForIni[0],
;;;787    			StackCountForIni[1]
;;;788    			
;;;789    			);		
;;;790    	halAfeBq796xxDebugMsg(str);
;;;791    
;;;792    #ifdef	AFE_DEBUG_MODE
;;;793    	RealPaserCount[DIR_NORTH] = AFE_DEBUG_N_NUM;
;;;794    	RealPaserCount[DIR_SOUTH] = AFE_DEBUG_S_NUM;
;;;795    #endif
;;;796    	run_count++;
000024  7d60              LDRB     r0,[r4,#0x15]  ; run_count
000026  1c40              ADDS     r0,r0,#1
000028  7560              STRB     r0,[r4,#0x15]
;;;797    
;;;798    	if(StackCountForIni[BridgeDirection] < afeBmuNumber())
00002a  f7fffffe          BL       apiSysParGetBmuNumber
00002e  7a22              LDRB     r2,[r4,#8]  ; BridgeDirection
000030  2600              MOVS     r6,#0
;;;799    	{	
;;;800    		if((StackCountForIni[DIR_NORTH]+StackCountForIni[DIR_SOUTH]) <
;;;801    			afeBmuNumber())
;;;802    		{
;;;803    			fail_count++;
;;;804    			if(run_count >= CHECK_AFE_TIMES && fail_count >= (CHECK_AFE_TIMES/2))
;;;805    			{
;;;806    #if	0				
;;;807    				halAfeBq796xxDebugMsg("重新 Ini AFE");
;;;808    
;;;809    				//AfeState = AFE_STATE_INI;
;;;810    				//cnt_delay = 0;
;;;811    				//afe_steps = AFE_INIT_IDLE;
;;;812    				//BridgeDirection = DIR_SOUTH;//DIR_SOUTH;//DIR_NORTH;
;;;813    				//BridgeSwitchCount =0;
;;;814    				//NorthAndSouthIniFlag = 0;
;;;815    				changeToBq796xxIniHandler();
;;;816    				//AfeTimerHandlerProcessor = AfeBq796xxIniHandler;
;;;817    				AfeFailTimerCount = 0;
;;;818    				fail_count = 0;
;;;819    				run_count = 0;
;;;820    				return;
;;;821    #endif				
;;;822    			}
;;;823    		}
;;;824    		else
;;;825    		{
;;;826    			AfeCommTimeOutCount = 0;
;;;827    			fail_count = 0;
;;;828    			run_count = 0;
;;;829    		}
;;;830    		ReaAfeCycleCount10Ms = AFE_READ_CYCLE_COUNT_10MS / 2;
;;;831    		if(BridgeDirection == DIR_NORTH)
;;;832    		{
;;;833    			halAfeBq796xxDebugMsg("北橋資料不足");
;;;834    		}
;;;835    		else
;;;836    		{
;;;837    			halAfeBq796xxDebugMsg("南橋資料不足");
;;;838    		}
;;;839    		CHANGE_BRIDGE_DIRECTION();
000032  4f37              LDR      r7,|L14.272|
000034  5ca9              LDRB     r1,[r5,r2]            ;798
000036  4288              CMP      r0,r1                 ;798
000038  d91e              BLS      |L14.120|
00003a  f7fffffe          BL       apiSysParGetBmuNumber
00003e  7829              LDRB     r1,[r5,#0]            ;800  ; StackCountForIni
000040  786a              LDRB     r2,[r5,#1]            ;800  ; StackCountForIni
000042  4411              ADD      r1,r1,r2              ;800
000044  4288              CMP      r0,r1                 ;800
000046  d903              BLS      |L14.80|
000048  7d20              LDRB     r0,[r4,#0x14]         ;803  ; fail_count
00004a  1c40              ADDS     r0,r0,#1              ;803
00004c  7520              STRB     r0,[r4,#0x14]         ;803
00004e  e002              B        |L14.86|
                  |L14.80|
000050  70e6              STRB     r6,[r4,#3]            ;826
000052  7526              STRB     r6,[r4,#0x14]         ;827
000054  7566              STRB     r6,[r4,#0x15]         ;828
                  |L14.86|
000056  2019              MOVS     r0,#0x19              ;830
000058  8520              STRH     r0,[r4,#0x28]         ;830
00005a  7a20              LDRB     r0,[r4,#8]  ; BridgeDirection
00005c  f0800001          EOR      r0,r0,#1
000060  7220              STRB     r0,[r4,#8]
000062  6838              LDR      r0,[r7,#0]
000064  f4805000          EOR      r0,r0,#0x2000
000068  6038              STR      r0,[r7,#0]
;;;840    		
;;;841    		changeDirIni();
00006a  f7fffffe          BL       changeDirIni
;;;842    		getNextSubFunctionPointer();
00006e  f7fffffe          BL       getNextSubFunctionPointer
                  |L14.114|
;;;843    	}
;;;844    	else
;;;845    	{		
;;;846    		ReaAfeCycleCount10Ms = AFE_READ_CYCLE_COUNT_10MS;
;;;847    		sprintf(str,"Paser Count %d = %d",BridgeDirection, RealPaserCount[BridgeDirection]);
;;;848    		halAfeBq796xxDebugMsg(str);
;;;849    		if(RealPaserCount[BridgeDirection] != StackCountForIni[BridgeDirection])
;;;850    		{
;;;851    			PaserCountFailCount[BridgeDirection]++;
;;;852    			if(PaserCountFailCount[BridgeDirection] >= CHECK_AFE_TIMES)
;;;853    			{
;;;854    				StackCountForIni[BridgeDirection] = 0;
;;;855    				CHANGE_BRIDGE_DIRECTION();
;;;856    				halAfeBq796xxDebugMsg("切換方向");
;;;857    				changeDirIni();
;;;858    				getNextSubFunctionPointer();
;;;859    			}
;;;860    #if	0			
;;;861    			fail_count++;
;;;862    			if(run_count >= CHECK_AFE_TIMES && fail_count >= (CHECK_AFE_TIMES/2))
;;;863    			{
;;;864    				halAfeBq796xxDebugMsg("重新 Ini ");
;;;865    				//afe_steps = AFE_INIT_IDLE;
;;;866    				//BridgeDirection = DIR_SOUTH;//DIR_SOUTH;//DIR_NORTH;
;;;867    				//BridgeSwitchCount =0;
;;;868    				//NorthAndSouthIniFlag = 0;
;;;869    				//AfeState = AFE_STATE_INI;
;;;870    				//cnt_delay = 0;
;;;871    				changeToBq796xxIniHandler();
;;;872    				//AfeTimerHandlerProcessor = AfeBq796xxIniHandler;
;;;873    				AfeFailTimerCount = 0;
;;;874    				fail_count = 0;
;;;875    				run_count = 0;
;;;876    //				GPIOD->ODR |= GPIO_PIN_14;
;;;877    				return;
;;;878    			}
;;;879    			else
;;;880    			{
;;;881    				CHANGE_BRIDGE_DIRECTION();
;;;882    				changeDirIni();
;;;883    				AfeFunctionProcessor = changeBmuDirForDataReadProcessor;
;;;884    			}
;;;885    #endif			
;;;886    		}
;;;887    		else
;;;888    		{
;;;889    			AfeCommTimeOutCount = 0;
;;;890    			getNextMainFunctionPointer();
;;;891    			
;;;892    			PaserCountFailCount[BridgeDirection] = 0;
;;;893    			fail_count = 0;
;;;894    			run_count = 0;
;;;895    		}		
;;;896    	}
;;;897    }
000072  b01c              ADD      sp,sp,#0x70
000074  e8bd81f0          POP      {r4-r8,pc}
                  |L14.120|
000078  2032              MOVS     r0,#0x32              ;846
00007a  8520              STRH     r0,[r4,#0x28]         ;846
00007c  f8df805c          LDR      r8,|L14.220|
000080  a124              ADR      r1,|L14.276|
000082  f1080802          ADD      r8,r8,#2              ;847
000086  a803              ADD      r0,sp,#0xc            ;847
000088  f8183002          LDRB     r3,[r8,r2]            ;847
00008c  f7fffffe          BL       __2sprintf
000090  7a20              LDRB     r0,[r4,#8]            ;849  ; BridgeDirection
000092  f8181000          LDRB     r1,[r8,r0]            ;849
000096  5c2a              LDRB     r2,[r5,r0]            ;849
000098  f1080802          ADD      r8,r8,#2              ;851
00009c  4291              CMP      r1,r2                 ;849
00009e  d014              BEQ      |L14.202|
0000a0  f8181000          LDRB     r1,[r8,r0]            ;851
0000a4  1c49              ADDS     r1,r1,#1              ;851
0000a6  b2c9              UXTB     r1,r1                 ;851
0000a8  f8081000          STRB     r1,[r8,r0]            ;851
0000ac  2906              CMP      r1,#6                 ;852
0000ae  d3e0              BCC      |L14.114|
0000b0  542e              STRB     r6,[r5,r0]            ;854
0000b2  f0800001          EOR      r0,r0,#1              ;855
0000b6  7220              STRB     r0,[r4,#8]            ;855
0000b8  6838              LDR      r0,[r7,#0]            ;855
0000ba  f4805000          EOR      r0,r0,#0x2000         ;855
0000be  6038              STR      r0,[r7,#0]            ;855
0000c0  f7fffffe          BL       changeDirIni
0000c4  f7fffffe          BL       getNextSubFunctionPointer
0000c8  e7d3              B        |L14.114|
                  |L14.202|
0000ca  70e6              STRB     r6,[r4,#3]            ;889
0000cc  f7fffffe          BL       getNextMainFunctionPointer
0000d0  7a20              LDRB     r0,[r4,#8]            ;892  ; BridgeDirection
0000d2  f8086000          STRB     r6,[r8,r0]            ;892
0000d6  7526              STRB     r6,[r4,#0x14]         ;893
0000d8  7566              STRB     r6,[r4,#0x15]         ;894
0000da  e7ca              B        |L14.114|
;;;898    
                          ENDP

                  |L14.220|
                          DCD      ||.data||+0x22
                  |L14.224|
0000e0  66696e69          DCB      "finish afe read:Dir=%d Error:%d/%d Num=%d %d",0
0000e4  73682061
0000e8  66652072
0000ec  6561643a
0000f0  4469723d
0000f4  25642045
0000f8  72726f72
0000fc  3a25642f
000100  2564204e
000104  756d3d25
000108  64202564
00010c  00      
00010d  00                DCB      0
00010e  00                DCB      0
00010f  00                DCB      0
                  |L14.272|
                          DCD      0x48000c14
                  |L14.276|
000114  50617365          DCB      "Paser Count %d = %d",0
000118  7220436f
00011c  756e7420
000120  2564203d
000124  20256400

                          AREA ||i.getNextMainFunctionPointer||, CODE, READONLY, ALIGN=2

                  getNextMainFunctionPointer PROC
;;;132    
;;;133    static void getNextMainFunctionPointer(void)
000000  4906              LDR      r1,|L15.28|
;;;134    {
;;;135    	MainFunIndex++;
000002  7b08              LDRB     r0,[r1,#0xc]  ; MainFunIndex
000004  1c40              ADDS     r0,r0,#1
000006  b2c0              UXTB     r0,r0
000008  7308              STRB     r0,[r1,#0xc]
;;;136    	AfeFunctionProcessor = afeMainFunctionTable[MainFunIndex];
00000a  4a05              LDR      r2,|L15.32|
00000c  f8520020          LDR      r0,[r2,r0,LSL #2]
000010  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;137    	if(AfeFunctionProcessor)
000012  2800              CMP      r0,#0
000014  d000              BEQ      |L15.24|
;;;138    		AfeFunctionProcessor();
000016  4700              BX       r0
                  |L15.24|
;;;139    }
000018  4770              BX       lr
;;;140    static void getNextSubFunctionPointer(void)
                          ENDP

00001a  0000              DCW      0x0000
                  |L15.28|
                          DCD      ||.data||
                  |L15.32|
                          DCD      ||.constdata||+0x90

                          AREA ||i.getNextSubFunctionPointer||, CODE, READONLY, ALIGN=2

                  getNextSubFunctionPointer PROC
;;;139    }
;;;140    static void getNextSubFunctionPointer(void)
000000  4903              LDR      r1,|L16.16|
;;;141    {
;;;142    //	uint32_t	addr;
;;;143    //	addr = (uint32_t)sunFunctionPointer;
;;;144    //	addr += 4;
;;;145    	sunFunctionPointer =(tAfeFunctionTable)((uint32_t)sunFunctionPointer+4);
000002  6b88              LDR      r0,[r1,#0x38]  ; sunFunctionPointer
000004  1d00              ADDS     r0,r0,#4
000006  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;146    //	sunFunctionPointer =(tAfeFunctionTable)addr;
;;;147    //	(uint32_t)sunFunctionPointer += 4U;
;;;148    //	sprintf(str,"Sub Fun Pointer=%.8lX",*(uint32_t *)((uint32_t)sunFunctionPointer+4));
;;;149    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000008  6800              LDR      r0,[r0,#0]
00000a  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;150    } 
00000c  4770              BX       lr
;;;151    
                          ENDP

00000e  0000              DCW      0x0000
                  |L16.16|
                          DCD      ||.data||

                          AREA ||i.halAfeGetState||, CODE, READONLY, ALIGN=2

                  halAfeGetState PROC
;;;1443   
;;;1444   uint8_t halAfeGetState(void)
000000  b510              PUSH     {r4,lr}
;;;1445   {
;;;1446   	if(appProjectIsInSimuMode())
000002  f7fffffe          BL       appProjectIsInSimuMode
000006  b108              CBZ      r0,|L17.12|
;;;1447   		return AFE_STATE_NORMAL;
000008  2000              MOVS     r0,#0
;;;1448   	return AfeState;
;;;1449   }
00000a  bd10              POP      {r4,pc}
                  |L17.12|
00000c  4801              LDR      r0,|L17.20|
00000e  7a80              LDRB     r0,[r0,#0xa]          ;1448  ; AfeState
000010  bd10              POP      {r4,pc}
;;;1450   
                          ENDP

000012  0000              DCW      0x0000
                  |L17.20|
                          DCD      ||.data||

                          AREA ||i.halAfeIsL1Protect||, CODE, READONLY, ALIGN=2

                  halAfeIsL1Protect PROC
;;;1419   /* Public function prototypes -----------------------------------------------*/
;;;1420   uint8_t halAfeIsL1Protect(void)
000000  4803              LDR      r0,|L18.16|
;;;1421   {
;;;1422   	if(AfeCommFlag & AFE_COMM_FLAG_L1)
000002  7900              LDRB     r0,[r0,#4]  ; AfeCommFlag
000004  07c0              LSLS     r0,r0,#31
000006  d001              BEQ      |L18.12|
;;;1423   		return 1;
000008  2001              MOVS     r0,#1
;;;1424   	return 0;
;;;1425   }
00000a  4770              BX       lr
                  |L18.12|
00000c  2000              MOVS     r0,#0                 ;1424
00000e  4770              BX       lr
;;;1426   uint8_t halAfeIsL2Protect(void)
                          ENDP

                  |L18.16|
                          DCD      ||.data||

                          AREA ||i.halAfeIsL2Protect||, CODE, READONLY, ALIGN=2

                  halAfeIsL2Protect PROC
;;;1425   }
;;;1426   uint8_t halAfeIsL2Protect(void)
000000  4803              LDR      r0,|L19.16|
;;;1427   {
;;;1428   	if(AfeCommFlag & AFE_COMM_FLAG_L2)
000002  7900              LDRB     r0,[r0,#4]  ; AfeCommFlag
000004  0780              LSLS     r0,r0,#30
000006  d501              BPL      |L19.12|
;;;1429   		return 1;
000008  2001              MOVS     r0,#1
;;;1430   	return 0;
;;;1431   }
00000a  4770              BX       lr
                  |L19.12|
00000c  2000              MOVS     r0,#0                 ;1430
00000e  4770              BX       lr
;;;1432   void halAfeSetPhysicalBalancePosition(uint8_t bmuindex, uint16_t position)
                          ENDP

                  |L19.16|
                          DCD      ||.data||

                          AREA ||i.halAfeSetBalanceOnFlag||, CODE, READONLY, ALIGN=2

                  halAfeSetBalanceOnFlag PROC
;;;1438   }
;;;1439   void halAfeSetBalanceOnFlag(uint8_t onflag)
000000  4901              LDR      r1,|L20.8|
;;;1440   {
;;;1441   	BalanceOnFlag = onflag;
000002  7188              STRB     r0,[r1,#6]
;;;1442   }
000004  4770              BX       lr
;;;1443   
                          ENDP

000006  0000              DCW      0x0000
                  |L20.8|
                          DCD      ||.data||

                          AREA ||i.halAfeSetPhysicalBalancePosition||, CODE, READONLY, ALIGN=2

                  halAfeSetPhysicalBalancePosition PROC
;;;1431   }
;;;1432   void halAfeSetPhysicalBalancePosition(uint8_t bmuindex, uint16_t position)
000000  4a01              LDR      r2,|L21.8|
;;;1433   {
;;;1434   #ifdef AFE_DEBUG_MODE	
;;;1435   	return;
;;;1436   #endif	
;;;1437   	BalanceData[bmuindex] = position;
000002  f8221010          STRH     r1,[r2,r0,LSL #1]
;;;1438   }
000006  4770              BX       lr
;;;1439   void halAfeSetBalanceOnFlag(uint8_t onflag)
                          ENDP

                  |L21.8|
                          DCD      ||.bss||

                          AREA ||i.halafeOpen||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_sizespec
                          REQUIRE _printf_percent
                          REQUIRE _printf_widthprec
                          REQUIRE _printf_x
                          REQUIRE _printf_longlong_hex
                  halafeOpen PROC
;;;1450   
;;;1451   void halafeOpen(tAfeEvtHandler evtHandler)
000000  b570              PUSH     {r4-r6,lr}
;;;1452   {
000002  b09a              SUB      sp,sp,#0x68
;;;1453   	afeEvtHandler = evtHandler;
000004  4c1d              LDR      r4,|L22.124|
000006  6360              STR      r0,[r4,#0x34]  ; afeEvtHandler
;;;1454   	AfeState = AFE_STATE_INI;
000008  2601              MOVS     r6,#1
00000a  72a6              STRB     r6,[r4,#0xa]
;;;1455   	AfeFailTimerCount  = 0;
00000c  2500              MOVS     r5,#0
00000e  8425              STRH     r5,[r4,#0x20]
;;;1456   	afe_load_data.bmu_total_num = afeBmuNumber();
000010  f7fffffe          BL       apiSysParGetBmuNumber
000014  f104013c          ADD      r1,r4,#0x3c
000018  7288              STRB     r0,[r1,#0xa]
;;;1457   	setupAfe2ndOvValue();
00001a  f7fffffe          BL       setupAfe2ndOvValue
;;;1458   	setupAfe2ndUvValue();
00001e  f7fffffe          BL       setupAfe2ndUvValue
;;;1459   	setupAfe2ndOtValue();
000022  f7fffffe          BL       setupAfe2ndOtValue
;;;1460   	setupAfe2ndUtValue();
000026  f7fffffe          BL       setupAfe2ndUtValue
;;;1461                                   
;;;1462     	drv_bq796xx_init_default_load(afe_load_data);
00002a  e9d41210          LDRD     r1,r2,[r4,#0x40]
00002e  6be0              LDR      r0,[r4,#0x3c]  ; afe_load_data
000030  f7fffffe          BL       drv_bq796xx_init_default_load
;;;1463   
;;;1464   	drv_bq796xx_init();
000034  f7fffffe          BL       drv_bq796xx_init
;;;1465   	bq796xx_event_RegisteCB(app_afe_cb);
000038  4811              LDR      r0,|L22.128|
00003a  f7fffffe          BL       bq796xx_event_RegisteCB
;;;1466   	afe_steps = AFE_INIT_IDLE;
00003e  7025              STRB     r5,[r4,#0]
;;;1467   	BridgeDirection = DIR_SOUTH;//DIR_SOUTH;//DIR_NORTH;
000040  7226              STRB     r6,[r4,#8]
;;;1468   	BridgeSwitchCount =0;
000042  7265              STRB     r5,[r4,#9]
;;;1469   	NorthAndSouthIniFlag = 0;
000044  72e5              STRB     r5,[r4,#0xb]
;;;1470   #ifdef	AFE_DEBUG_MODE	
;;;1471   	AfeState = AFE_STATE_NORMAL;
;;;1472   	AfeTimerHandlerProcessor = AfeBq796xxNormalHandler;
;;;1473   	StackCountForIni[DIR_NORTH] = AFE_DEBUG_N_NUM;
;;;1474   	StackCountForIni[DIR_SOUTH] = AFE_DEBUG_S_NUM;
;;;1475   	BalanceData[0] = 0x0102;
;;;1476   	BalanceData[1] = 0x0304;
;;;1477   	BalanceData[2] = 0x0506;
;;;1478   	BalanceData[3] = 0x0708;
;;;1479   	BridgeDirection = DIR_SOUTH;
;;;1480   #else	
;;;1481   	changeToBq796xxIniHandler();
000046  f7fffffe          BL       changeToBq796xxIniHandler
;;;1482   	//AfeTimerHandlerProcessor = AfeBq796xxIniHandler;
;;;1483   #endif
;;;1484   	LibSwTimerOpen(afeSwTimerHandler, 0);
00004a  2100              MOVS     r1,#0
00004c  480d              LDR      r0,|L22.132|
00004e  f7fffffe          BL       LibSwTimerOpen
;;;1485   	{	
;;;1486   		char	str[100];
;;;1487   		sunFunctionPointer = (tAfeFunctionTable )stopBalanceFunctionTable;			
000052  4a0d              LDR      r2,|L22.136|
000054  63a2              STR      r2,[r4,#0x38]  ; sunFunctionPointer
;;;1488   		sprintf(str,"Sub Fun Pointer=%.8lX",(uint32_t)sunFunctionPointer);
000056  a10d              ADR      r1,|L22.140|
000058  a801              ADD      r0,sp,#4
00005a  f7fffffe          BL       __2sprintf
;;;1489   		halAfeBq796xxDebugMsg(str);
;;;1490   		
;;;1491   		sprintf(str,"Sub Fun Pointer=%.8lX",*(uint32_t *)((uint32_t)sunFunctionPointer+4));
00005e  6ba0              LDR      r0,[r4,#0x38]  ; sunFunctionPointer
000060  a10a              ADR      r1,|L22.140|
000062  6842              LDR      r2,[r0,#4]
000064  a801              ADD      r0,sp,#4
000066  f7fffffe          BL       __2sprintf
;;;1492   		halAfeBq796xxDebugMsg(str);
;;;1493   		
;;;1494   		sunFunctionPointer = (tAfeFunctionTable )stopBalanceFunctionTable[0];		
00006a  4a0e              LDR      r2,|L22.164|
00006c  63a2              STR      r2,[r4,#0x38]  ; sunFunctionPointer
;;;1495   		sprintf(str,"Sub Fun Pointer=%.8lX",(uint32_t)sunFunctionPointer);
00006e  a107              ADR      r1,|L22.140|
000070  a801              ADD      r0,sp,#4
000072  f7fffffe          BL       __2sprintf
;;;1496   		halAfeBq796xxDebugMsg(str);
;;;1497   	}
;;;1498   }
000076  b01a              ADD      sp,sp,#0x68
000078  bd70              POP      {r4-r6,pc}
;;;1499   
                          ENDP

00007a  0000              DCW      0x0000
                  |L22.124|
                          DCD      ||.data||
                  |L22.128|
                          DCD      app_afe_cb
                  |L22.132|
                          DCD      afeSwTimerHandler
                  |L22.136|
                          DCD      ||.constdata||
                  |L22.140|
00008c  53756220          DCB      "Sub Fun Pointer=%.8lX",0
000090  46756e20
000094  506f696e
000098  7465723d
00009c  252e386c
0000a0  5800    
0000a2  00                DCB      0
0000a3  00                DCB      0
                  |L22.164|
                          DCD      stopBalanceLoCell

                          AREA ||i.isLastBmuForBalance||, CODE, READONLY, ALIGN=2

                  isLastBmuForBalance PROC
;;;454    
;;;455    static uint8_t isLastBmuForBalance(void)
000000  4908              LDR      r1,|L23.36|
;;;456    {
;;;457    	BalanceBmuIndex++;
000002  7c88              LDRB     r0,[r1,#0x12]  ; BalanceBmuIndex
000004  1c40              ADDS     r0,r0,#1
000006  b2c0              UXTB     r0,r0
000008  7488              STRB     r0,[r1,#0x12]
;;;458    	if(BalanceBmuIndex >= StackCountForIni[BridgeDirection])
00000a  7a0b              LDRB     r3,[r1,#8]  ; BridgeDirection
00000c  f1010222          ADD      r2,r1,#0x22
000010  5cd2              LDRB     r2,[r2,r3]
000012  4282              CMP      r2,r0
000014  d803              BHI      |L23.30|
;;;459    	{
;;;460    		BalanceBmuIndex = 0;
000016  2000              MOVS     r0,#0
000018  7488              STRB     r0,[r1,#0x12]
;;;461    		return 1;
00001a  2001              MOVS     r0,#1
;;;462    	}
;;;463    	return 0;
;;;464    }
00001c  4770              BX       lr
                  |L23.30|
00001e  2000              MOVS     r0,#0                 ;463
000020  4770              BX       lr
;;;465    
                          ENDP

000022  0000              DCW      0x0000
                  |L23.36|
                          DCD      ||.data||

                          AREA ||i.mainFunChangeChannel||, CODE, READONLY, ALIGN=2

                  mainFunChangeChannel PROC
;;;283    }
;;;284    static void mainFunChangeChannel(void)
000000  b510              PUSH     {r4,lr}
;;;285    {
;;;286    	if(StackCountForIni[BridgeDirection] < afeBmuNumber())
000002  f7fffffe          BL       apiSysParGetBmuNumber
000006  4b11              LDR      r3,|L24.76|
000008  f1a30222          SUB      r2,r3,#0x22
00000c  7a11              LDRB     r1,[r2,#8]  ; BridgeDirection
00000e  5c5c              LDRB     r4,[r3,r1]
000010  2300              MOVS     r3,#0
000012  42a0              CMP      r0,r4
000014  d90b              BLS      |L24.46|
;;;287    	{
;;;288    		if(BridgeDirection == DIR_NORTH)
000016  b9a1              CBNZ     r1,|L24.66|
;;;289    		{
;;;290    			ntcChannelStartIndex += ntcChannelOffset;
000018  7bd0              LDRB     r0,[r2,#0xf]  ; ntcChannelStartIndex
00001a  7c11              LDRB     r1,[r2,#0x10]  ; ntcChannelOffset
00001c  4408              ADD      r0,r0,r1
00001e  b2c0              UXTB     r0,r0
000020  73d0              STRB     r0,[r2,#0xf]
;;;291    			if(ntcChannelStartIndex >= NTC_CH_NUM)
000022  2810              CMP      r0,#0x10
000024  d301              BCC      |L24.42|
;;;292    				ntcChannelStartIndex -= NTC_CH_NUM;
000026  3810              SUBS     r0,r0,#0x10
000028  73d0              STRB     r0,[r2,#0xf]
                  |L24.42|
;;;293    			ntcChannelOffset = 0;
00002a  7413              STRB     r3,[r2,#0x10]
00002c  e009              B        |L24.66|
                  |L24.46|
;;;294    		}
;;;295    	}
;;;296    	else
;;;297    	{
;;;298    		ntcChannelStartIndex += ntcChannelOffset;
00002e  7bd0              LDRB     r0,[r2,#0xf]  ; ntcChannelStartIndex
000030  7c11              LDRB     r1,[r2,#0x10]  ; ntcChannelOffset
000032  4408              ADD      r0,r0,r1
000034  b2c0              UXTB     r0,r0
000036  73d0              STRB     r0,[r2,#0xf]
;;;299    		if(ntcChannelStartIndex >= NTC_CH_NUM)
000038  2810              CMP      r0,#0x10
00003a  d301              BCC      |L24.64|
;;;300    			ntcChannelStartIndex -= NTC_CH_NUM;
00003c  3810              SUBS     r0,r0,#0x10
00003e  73d0              STRB     r0,[r2,#0xf]
                  |L24.64|
;;;301    		ntcChannelOffset = 0;
000040  7413              STRB     r3,[r2,#0x10]
                  |L24.66|
;;;302    	}			
;;;303    	getNextMainFunctionPointer();
000042  e8bd4010          POP      {r4,lr}
000046  f7ffbffe          B.W      getNextMainFunctionPointer
;;;304    }
;;;305    
                          ENDP

00004a  0000              DCW      0x0000
                  |L24.76|
                          DCD      ||.data||+0x22

                          AREA ||i.mainFunEnd||, CODE, READONLY, ALIGN=2

                  mainFunEnd PROC
;;;1013   
;;;1014   static void mainFunEnd(void)
000000  4901              LDR      r1,|L25.8|
;;;1015   {
;;;1016   	//halAfeBq796xxDebugMsg("afeFunEnd");
;;;1017   	AfeFunctionProcessor = 0;
000002  2000              MOVS     r0,#0
000004  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;1018   }
000006  4770              BX       lr
;;;1019   
                          ENDP

                  |L25.8|
                          DCD      ||.data||

                          AREA ||i.mainFunFinishAfeRead||, CODE, READONLY, ALIGN=2

                  mainFunFinishAfeRead PROC
;;;444    
;;;445    static void mainFunFinishAfeRead(void)
000000  4903              LDR      r1,|L26.16|
;;;446    {
;;;447    	//halAfeBq796xxDebugMsg("mainFunFinishAfeRead");
;;;448    	sunFunctionPointer = (tAfeFunctionTable )changeDirectionFunctionTable;	
000002  4802              LDR      r0,|L26.12|
000004  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;449    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000006  6800              LDR      r0,[r0,#0]
000008  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;450    }
00000a  4770              BX       lr
;;;451    
                          ENDP

                  |L26.12|
                          DCD      ||.constdata||+0x74
                  |L26.16|
                          DCD      ||.data||

                          AREA ||i.mainFunGetCellVoltage||, CODE, READONLY, ALIGN=2

                  mainFunGetCellVoltage PROC
;;;345    
;;;346    static void mainFunGetCellVoltage(void)
000000  4903              LDR      r1,|L27.16|
;;;347    {
;;;348    	//halAfeBq796xxDebugMsg("mainFunGetCellVoltage");
;;;349    	sunFunctionPointer = (tAfeFunctionTable )getCellVoltageFunctionTable;	
000002  4802              LDR      r0,|L27.12|
000004  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;350    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000006  6800              LDR      r0,[r0,#0]
000008  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;351    }
00000a  4770              BX       lr
;;;352    
                          ENDP

                  |L27.12|
                          DCD      ||.constdata||+0x34
                  |L27.16|
                          DCD      ||.data||

                          AREA ||i.mainFunGetNtc||, CODE, READONLY, ALIGN=2

                  mainFunGetNtc PROC
;;;316    };
;;;317    static void mainFunGetNtc(void)
000000  4903              LDR      r1,|L28.16|
;;;318    {
;;;319    	ntcIoIndex = 0;
000002  2000              MOVS     r0,#0
000004  7388              STRB     r0,[r1,#0xe]
;;;320    	//halAfeBq796xxDebugMsg("mainFunGetNtc");
;;;321    	sunFunctionPointer = (tAfeFunctionTable )getNtcFunctionTable;	
000006  4803              LDR      r0,|L28.20|
000008  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;322    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
00000a  6800              LDR      r0,[r0,#0]
00000c  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;323    }
00000e  4770              BX       lr
;;;324    
                          ENDP

                  |L28.16|
                          DCD      ||.data||
                  |L28.20|
                          DCD      ||.constdata||+0x10

                          AREA ||i.mainFunGetOtUtFlag||, CODE, READONLY, ALIGN=2

                  mainFunGetOtUtFlag PROC
;;;429    
;;;430    static void mainFunGetOtUtFlag(void)
000000  4903              LDR      r1,|L29.16|
;;;431    {
;;;432    	//halAfeBq796xxDebugMsg("mainFunGetOtUtFlag");
;;;433    	sunFunctionPointer = (tAfeFunctionTable )getOtUtFlagFunctionTable;	
000002  4802              LDR      r0,|L29.12|
000004  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;434    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000006  6800              LDR      r0,[r0,#0]
000008  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;435    }
00000a  4770              BX       lr
;;;436    
                          ENDP

                  |L29.12|
                          DCD      ||.constdata||+0x64
                  |L29.16|
                          DCD      ||.data||

                          AREA ||i.mainFunGetOvUvFlag||, CODE, READONLY, ALIGN=2

                  mainFunGetOvUvFlag PROC
;;;401    
;;;402    static void mainFunGetOvUvFlag(void)
000000  4903              LDR      r1,|L30.16|
;;;403    {
;;;404    	//halAfeBq796xxDebugMsg("mainFunGetOvUvFlag");
;;;405    	sunFunctionPointer = (tAfeFunctionTable )getOvUvFlagFunctionTable;	
000002  4802              LDR      r0,|L30.12|
000004  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;406    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000006  6800              LDR      r0,[r0,#0]
000008  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;407    }
00000a  4770              BX       lr
;;;408    
                          ENDP

                  |L30.12|
                          DCD      ||.constdata||+0x54
                  |L30.16|
                          DCD      ||.data||

                          AREA ||i.mainFunGetSummary||, CODE, READONLY, ALIGN=2

                  mainFunGetSummary PROC
;;;373    
;;;374    static void mainFunGetSummary(void)
000000  4903              LDR      r1,|L31.16|
;;;375    {
;;;376    	//halAfeBq796xxDebugMsg("mainFunGetSummary");
;;;377    	sunFunctionPointer = (tAfeFunctionTable )getSummaryFunctionTable;	
000002  4802              LDR      r0,|L31.12|
000004  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;378    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000006  6800              LDR      r0,[r0,#0]
000008  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;379    }
00000a  4770              BX       lr
;;;380    
                          ENDP

                  |L31.12|
                          DCD      ||.constdata||+0x44
                  |L31.16|
                          DCD      ||.data||

                          AREA ||i.mainFunStartBalance||, CODE, READONLY, ALIGN=2

                  mainFunStartBalance PROC
;;;577    
;;;578    static void mainFunStartBalance(void)
000000  b510              PUSH     {r4,lr}
;;;579    {
;;;580    	if(StackCountForIni[BridgeDirection] < afeBmuNumber())
000002  f7fffffe          BL       apiSysParGetBmuNumber
000006  4b0c              LDR      r3,|L32.56|
000008  f1a30222          SUB      r2,r3,#0x22
00000c  7a11              LDRB     r1,[r2,#8]  ; BridgeDirection
00000e  5c5b              LDRB     r3,[r3,r1]
000010  4298              CMP      r0,r3
000012  d905              BLS      |L32.32|
;;;581    	{
;;;582    		if(BridgeDirection == DIR_NORTH)
000014  b941              CBNZ     r1,|L32.40|
;;;583    		{
;;;584    			BalanceOddFlag ^= 0x01;
000016  79d0              LDRB     r0,[r2,#7]  ; BalanceOddFlag
000018  f0800001          EOR      r0,r0,#1
00001c  71d0              STRB     r0,[r2,#7]
00001e  e003              B        |L32.40|
                  |L32.32|
;;;585    			//halAfeBq796xxDebugMsg("Setup Odd Even...1");
;;;586    		}
;;;587    	}
;;;588    	else
;;;589    	{
;;;590    		BalanceOddFlag ^= 0x01;
000020  79d0              LDRB     r0,[r2,#7]  ; BalanceOddFlag
000022  f0800001          EOR      r0,r0,#1
000026  71d0              STRB     r0,[r2,#7]
                  |L32.40|
;;;591    		//halAfeBq796xxDebugMsg("Setup Odd Even...2");
;;;592    	}			
;;;593    	BalanceBmuIndex = 0;
000028  2000              MOVS     r0,#0
00002a  7490              STRB     r0,[r2,#0x12]
;;;594    	
;;;595    	//halAfeBq796xxDebugMsg("mainFunStartBalance");
;;;596    	sunFunctionPointer = (tAfeFunctionTable )startBalanceFunctionTable;	
00002c  4803              LDR      r0,|L32.60|
00002e  6390              STR      r0,[r2,#0x38]  ; sunFunctionPointer
;;;597    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000030  6800              LDR      r0,[r0,#0]
000032  6310              STR      r0,[r2,#0x30]  ; AfeFunctionProcessor
;;;598    }
000034  bd10              POP      {r4,pc}
;;;599    
                          ENDP

000036  0000              DCW      0x0000
                  |L32.56|
                          DCD      ||.data||+0x22
                  |L32.60|
                          DCD      ||.constdata||+0x80

                          AREA ||i.mainFunStartGetNtc||, CODE, READONLY, ALIGN=2

                  mainFunStartGetNtc PROC
;;;278    
;;;279    static void mainFunStartGetNtc(void)
000000  4902              LDR      r1,|L33.12|
;;;280    {
;;;281    	ntcChannelOffset = 0;
000002  2000              MOVS     r0,#0
000004  7408              STRB     r0,[r1,#0x10]
;;;282    	getNextMainFunctionPointer();
000006  f7ffbffe          B.W      getNextMainFunctionPointer
;;;283    }
;;;284    static void mainFunChangeChannel(void)
                          ENDP

00000a  0000              DCW      0x0000
                  |L33.12|
                          DCD      ||.data||

                          AREA ||i.mainFunStopBalance||, CODE, READONLY, ALIGN=2

                  mainFunStopBalance PROC
;;;164    
;;;165    static void mainFunStopBalance(void)
000000  4903              LDR      r1,|L34.16|
;;;166    {
;;;167    	/*
;;;168    	if(IsBalanceEnable == 0)
;;;169    	{
;;;170    		halAfeBq796xxDebugMsg("mainFunStopBalance");
;;;171    		getNextMainFunctionPointer();
;;;172    	}
;;;173    	*/
;;;174    	//halAfeBq796xxDebugMsg("mainFunStopBalance");
;;;175    	sunFunctionPointer = (tAfeFunctionTable )stopBalanceFunctionTable;	
000002  4802              LDR      r0,|L34.12|
000004  6388              STR      r0,[r1,#0x38]  ; sunFunctionPointer
;;;176    	AfeFunctionProcessor = (tAfeFunctionTable )(*((uint32_t *)sunFunctionPointer));
000006  6800              LDR      r0,[r0,#0]
000008  6308              STR      r0,[r1,#0x30]  ; AfeFunctionProcessor
;;;177    }
00000a  4770              BX       lr
;;;178    static uint8_t	ntcIoIndex = 0;
                          ENDP

                  |L34.12|
                          DCD      ||.constdata||
                  |L34.16|
                          DCD      ||.data||

                          AREA ||i.paserAfeResponse||, CODE, READONLY, ALIGN=2

                  paserAfeResponse PROC
;;;246    }
;;;247    static void paserAfeResponse(void)
000000  b570              PUSH     {r4-r6,lr}
;;;248    {
;;;249    	uint8_t res,i;
;;;250    	
;;;251    	if(PaserCountPerOneTimes == 0) 
000002  4e17              LDR      r6,|L35.96|
000004  7eb0              LDRB     r0,[r6,#0x1a]  ; PaserCountPerOneTimes
000006  2800              CMP      r0,#0
000008  d001              BEQ      |L35.14|
;;;252    	{
;;;253    		getNextSubFunctionPointer();
;;;254    		return;
;;;255    	}
;;;256    	for(i=0; i<PaserCountPerOneTimes; i++)
00000a  2400              MOVS     r4,#0
00000c  e023              B        |L35.86|
                  |L35.14|
00000e  e8bd4070          POP      {r4-r6,lr}            ;253
000012  f7ffbffe          B.W      getNextSubFunctionPointer
                  |L35.22|
;;;257    	{
;;;258    		GPIOD->ODR |= GPIO_PIN_15;
000016  4d13              LDR      r5,|L35.100|
000018  6828              LDR      r0,[r5,#0]
00001a  f4404000          ORR      r0,r0,#0x8000
00001e  6028              STR      r0,[r5,#0]
;;;259    		//GPIOD->ODR ^= GPIO_PIN_14;
;;;260    		res = drv_bq796xx_data_frame_parser();
000020  f7fffffe          BL       drv_bq796xx_data_frame_parser
;;;261    		GPIOD->ODR &= ~GPIO_PIN_15;
000024  6829              LDR      r1,[r5,#0]
000026  f4214100          BIC      r1,r1,#0x8000
00002a  6029              STR      r1,[r5,#0]
;;;262    
;;;263    		if(res == BQ796XX_RES_OK)
00002c  2801              CMP      r0,#1
00002e  d105              BNE      |L35.60|
;;;264    		{
;;;265    			RealPaserCount[BridgeDirection]++;
000030  4a0b              LDR      r2,|L35.96|
000032  7a30              LDRB     r0,[r6,#8]  ; BridgeDirection
000034  3224              ADDS     r2,r2,#0x24
000036  5c11              LDRB     r1,[r2,r0]
000038  1c49              ADDS     r1,r1,#1
00003a  5411              STRB     r1,[r2,r0]
                  |L35.60|
;;;266    		}
;;;267    		//	break;
;;;268    		PaserIndex++;
00003c  7e70              LDRB     r0,[r6,#0x19]  ; PaserIndex
00003e  1c40              ADDS     r0,r0,#1
000040  b2c0              UXTB     r0,r0
000042  7670              STRB     r0,[r6,#0x19]
;;;269    		if(PaserIndex >= PaserCount)	//
000044  7e31              LDRB     r1,[r6,#0x18]  ; PaserCount
000046  4288              CMP      r0,r1
000048  d303              BCC      |L35.82|
;;;270    		{
;;;271    			getNextSubFunctionPointer();
00004a  e8bd4070          POP      {r4-r6,lr}
00004e  f7ffbffe          B.W      getNextSubFunctionPointer
                  |L35.82|
000052  1c64              ADDS     r4,r4,#1              ;256
000054  b2e4              UXTB     r4,r4                 ;256
                  |L35.86|
000056  7eb0              LDRB     r0,[r6,#0x1a]         ;256  ; PaserCountPerOneTimes
000058  4284              CMP      r4,r0                 ;256
00005a  d3dc              BCC      |L35.22|
;;;272    			return;
;;;273    		}
;;;274    	}
;;;275    }
00005c  bd70              POP      {r4-r6,pc}
;;;276    
                          ENDP

00005e  0000              DCW      0x0000
                  |L35.96|
                          DCD      ||.data||
                  |L35.100|
                          DCD      0x48000c14

                          AREA ||i.sendOutBalanceDataHi||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_widthprec
                          REQUIRE _printf_d
                          REQUIRE _printf_x
                          REQUIRE _printf_int_dec
                          REQUIRE _printf_longlong_hex
                  sendOutBalanceDataHi PROC
;;;517    
;;;518    static void sendOutBalanceDataHi(void)
000000  b5f0              PUSH     {r4-r7,lr}
;;;519    {
000002  b09d              SUB      sp,sp,#0x74
;;;520    	char	str[100];
;;;521    	uint8_t		dat;
;;;522    	uint8_t		bmuindex;
;;;523    	uint8_t		RealBalanceIndex;
;;;524    	
;;;525    	if(BalanceOnFlag == 0)
000004  4e25              LDR      r6,|L36.156|
000006  79b0              LDRB     r0,[r6,#6]  ; BalanceOnFlag
000008  2800              CMP      r0,#0
00000a  d002              BEQ      |L36.18|
;;;526    	{
;;;527    		IsBalanceEnable = 0;
;;;528    		getNextMainFunctionPointer();
;;;529    		return;
;;;530    	}
;;;531    	for(bmuindex=0; bmuindex<afeBmuNumber(); bmuindex++)
00000c  2500              MOVS     r5,#0
;;;532    	{
;;;533    		if(BridgeDirection == DIR_NORTH)
;;;534    			RealBalanceIndex = BalanceBmuIndex;
;;;535    		else
;;;536    			RealBalanceIndex = afeBmuNumber() - BalanceBmuIndex - 1;	
;;;537    #ifdef AFE_DEBUG_MODE
;;;538    		dat =(uint8_t)((BalanceData[RealBalanceIndex] & 0xFF00) / 0x100);
;;;539    #else		
;;;540    		if(BalanceOddFlag)
;;;541    			dat =(uint8_t)((BalanceData[RealBalanceIndex] & 0x5500) / 0x100);
00000e  4f24              LDR      r7,|L36.160|
000010  e03e              B        |L36.144|
                  |L36.18|
000012  2000              MOVS     r0,#0                 ;527
000014  7170              STRB     r0,[r6,#5]            ;527
000016  f7fffffe          BL       getNextMainFunctionPointer
                  |L36.26|
;;;542    		else
;;;543    			dat =(uint8_t)((BalanceData[RealBalanceIndex] & 0xAA00) / 0x100);
;;;544    #endif			
;;;545    		sprintf(str, "Dir=%d Bmu#=%d Odd=%d Bmu=%d Balance Hi = %.2X",
;;;546    					BridgeDirection,
;;;547    					StackCountForIni[BridgeDirection],
;;;548    					BalanceOddFlag,
;;;549    					BalanceBmuIndex + 1, 
;;;550    					dat);
;;;551    		//halAfeBq796xxDebugMsg(str);
;;;552    		if(dat)
;;;553    		{
;;;554    			IsBalanceEnable = 1;
;;;555    			drv_bq796xx_CellBalance_9to16_set(BalanceBmuIndex + 1, dat, CB_TIME_10S, 0);
;;;556    		}
;;;557    		if(isLastBmuForBalance())
;;;558    		{
;;;559    			//halAfeBq796xxDebugMsg("Next sub fun-H");
;;;560    			getNextSubFunctionPointer();
;;;561    			break;
;;;562    		}
;;;563    		if(dat)
;;;564    			break;
;;;565    	}
;;;566    	
;;;567    }
00001a  b01d              ADD      sp,sp,#0x74
00001c  bdf0              POP      {r4-r7,pc}
                  |L36.30|
00001e  7a30              LDRB     r0,[r6,#8]            ;533  ; BridgeDirection
000020  b168              CBZ      r0,|L36.62|
000022  f7fffffe          BL       apiSysParGetBmuNumber
000026  7cb1              LDRB     r1,[r6,#0x12]         ;536  ; BalanceBmuIndex
000028  1a40              SUBS     r0,r0,r1              ;536
00002a  1e40              SUBS     r0,r0,#1              ;536
00002c  b2c0              UXTB     r0,r0                 ;536
                  |L36.46|
00002e  79f1              LDRB     r1,[r6,#7]            ;540  ; BalanceOddFlag
000030  b139              CBZ      r1,|L36.66|
000032  f8370010          LDRH     r0,[r7,r0,LSL #1]     ;541
000036  f40040aa          AND      r0,r0,#0x5500         ;541
00003a  0a04              LSRS     r4,r0,#8              ;541
00003c  e006              B        |L36.76|
                  |L36.62|
00003e  7cb0              LDRB     r0,[r6,#0x12]         ;534  ; BalanceBmuIndex
000040  e7f5              B        |L36.46|
                  |L36.66|
000042  f8370010          LDRH     r0,[r7,r0,LSL #1]     ;543
000046  f400402a          AND      r0,r0,#0xaa00         ;543
00004a  0a04              LSRS     r4,r0,#8              ;543
                  |L36.76|
00004c  7cb0              LDRB     r0,[r6,#0x12]         ;545  ; BalanceBmuIndex
00004e  1c40              ADDS     r0,r0,#1              ;545
000050  e9cd0401          STRD     r0,r4,[sp,#4]         ;545
000054  9100              STR      r1,[sp,#0]            ;545
000056  4811              LDR      r0,|L36.156|
000058  7a32              LDRB     r2,[r6,#8]            ;545  ; BridgeDirection
00005a  3022              ADDS     r0,r0,#0x22           ;545
00005c  a111              ADR      r1,|L36.164|
00005e  5c83              LDRB     r3,[r0,r2]            ;545
000060  a804              ADD      r0,sp,#0x10           ;545
000062  f7fffffe          BL       __2sprintf
000066  b14c              CBZ      r4,|L36.124|
000068  2001              MOVS     r0,#1                 ;554
00006a  7170              STRB     r0,[r6,#5]            ;554
00006c  7cb0              LDRB     r0,[r6,#0x12]         ;555  ; BalanceBmuIndex
00006e  2300              MOVS     r3,#0                 ;555
000070  1c40              ADDS     r0,r0,#1              ;555
000072  b2c0              UXTB     r0,r0                 ;555
000074  2201              MOVS     r2,#1                 ;555
000076  4621              MOV      r1,r4                 ;555
000078  f7fffffe          BL       drv_bq796xx_CellBalance_9to16_set
                  |L36.124|
00007c  f7fffffe          BL       isLastBmuForBalance
000080  b110              CBZ      r0,|L36.136|
000082  f7fffffe          BL       getNextSubFunctionPointer
000086  e7c8              B        |L36.26|
                  |L36.136|
000088  2c00              CMP      r4,#0                 ;563
00008a  d1c6              BNE      |L36.26|
00008c  1c6d              ADDS     r5,r5,#1              ;531
00008e  b2ed              UXTB     r5,r5                 ;531
                  |L36.144|
000090  f7fffffe          BL       apiSysParGetBmuNumber
000094  42a8              CMP      r0,r5                 ;531
000096  d8c2              BHI      |L36.30|
000098  e7bf              B        |L36.26|
;;;568    
                          ENDP

00009a  0000              DCW      0x0000
                  |L36.156|
                          DCD      ||.data||
                  |L36.160|
                          DCD      ||.bss||
                  |L36.164|
0000a4  4469723d          DCB      "Dir=%d Bmu#=%d Odd=%d Bmu=%d Balance Hi = %.2X",0
0000a8  25642042
0000ac  6d75233d
0000b0  2564204f
0000b4  64643d25
0000b8  6420426d
0000bc  753d2564
0000c0  2042616c
0000c4  616e6365
0000c8  20486920
0000cc  3d20252e
0000d0  325800  
0000d3  00                DCB      0

                          AREA ||i.sendOutBalanceDataLo||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_widthprec
                          REQUIRE _printf_d
                          REQUIRE _printf_x
                          REQUIRE _printf_int_dec
                          REQUIRE _printf_longlong_hex
                  sendOutBalanceDataLo PROC
;;;466    
;;;467    static void sendOutBalanceDataLo(void)
000000  b5f0              PUSH     {r4-r7,lr}
;;;468    {
000002  b09d              SUB      sp,sp,#0x74
;;;469    	char	str[100];
;;;470    	uint8_t		dat;
;;;471    	uint8_t		bmuindex;
;;;472    	uint8_t		RealBalanceIndex;
;;;473    	//BalanceOnFlag = 1;
;;;474    	if(BalanceOnFlag == 0)
000004  4e24              LDR      r6,|L37.152|
000006  79b0              LDRB     r0,[r6,#6]  ; BalanceOnFlag
000008  2800              CMP      r0,#0
00000a  d002              BEQ      |L37.18|
;;;475    	{
;;;476    		IsBalanceEnable = 0;
;;;477    		getNextMainFunctionPointer();
;;;478    		return;
;;;479    	}
;;;480    	for(bmuindex=0; bmuindex<afeBmuNumber(); bmuindex++)
00000c  2500              MOVS     r5,#0
;;;481    	{
;;;482    		if(BridgeDirection == DIR_NORTH)
;;;483    			RealBalanceIndex = BalanceBmuIndex;
;;;484    		else
;;;485    			RealBalanceIndex = afeBmuNumber() - BalanceBmuIndex - 1;
;;;486    		
;;;487    #ifdef AFE_DEBUG_MODE			
;;;488    		dat = (uint8_t)(BalanceData[RealBalanceIndex] & 0x00FF);
;;;489    #else
;;;490    		if(BalanceOddFlag)
;;;491    			dat = (uint8_t)(BalanceData[RealBalanceIndex] & 0x0055);
00000e  4f23              LDR      r7,|L37.156|
000010  e03c              B        |L37.140|
                  |L37.18|
000012  2000              MOVS     r0,#0                 ;476
000014  7170              STRB     r0,[r6,#5]            ;476
000016  f7fffffe          BL       getNextMainFunctionPointer
                  |L37.26|
;;;492    		else
;;;493    			dat = (uint8_t)(BalanceData[RealBalanceIndex] & 0x00AA);
;;;494    #endif			
;;;495    		sprintf(str, "Dir=%d Bmu#=%d Odd=%d Bmu=%d Balance Lo = %.2X",
;;;496    					BridgeDirection,
;;;497    					StackCountForIni[BridgeDirection],
;;;498    					BalanceOddFlag,
;;;499    					BalanceBmuIndex + 1, 
;;;500    					dat);
;;;501    		//halAfeBq796xxDebugMsg(str);
;;;502    		if(dat)
;;;503    		{
;;;504    			IsBalanceEnable = 1;
;;;505    			drv_bq796xx_CellBalance_1to8_set(BalanceBmuIndex + 1, dat, CB_TIME_10S, 0);
;;;506    		}
;;;507    		if(isLastBmuForBalance())
;;;508    		{
;;;509    			//halAfeBq796xxDebugMsg("Next sub fun-L");
;;;510    			getNextSubFunctionPointer();
;;;511    			break;
;;;512    		}
;;;513    		if(dat)
;;;514    			break;
;;;515    	}
;;;516    }
00001a  b01d              ADD      sp,sp,#0x74
00001c  bdf0              POP      {r4-r7,pc}
                  |L37.30|
00001e  7a30              LDRB     r0,[r6,#8]            ;482  ; BridgeDirection
000020  b160              CBZ      r0,|L37.60|
000022  f7fffffe          BL       apiSysParGetBmuNumber
000026  7cb1              LDRB     r1,[r6,#0x12]         ;485  ; BalanceBmuIndex
000028  1a40              SUBS     r0,r0,r1              ;485
00002a  1e40              SUBS     r0,r0,#1              ;485
00002c  b2c0              UXTB     r0,r0                 ;485
                  |L37.46|
00002e  79f1              LDRB     r1,[r6,#7]            ;490  ; BalanceOddFlag
000030  b131              CBZ      r1,|L37.64|
000032  f8170010          LDRB     r0,[r7,r0,LSL #1]     ;491
000036  f0000455          AND      r4,r0,#0x55           ;491
00003a  e005              B        |L37.72|
                  |L37.60|
00003c  7cb0              LDRB     r0,[r6,#0x12]         ;483  ; BalanceBmuIndex
00003e  e7f6              B        |L37.46|
                  |L37.64|
000040  f8170010          LDRB     r0,[r7,r0,LSL #1]     ;493
000044  f00004aa          AND      r4,r0,#0xaa           ;493
                  |L37.72|
000048  7cb0              LDRB     r0,[r6,#0x12]         ;495  ; BalanceBmuIndex
00004a  1c40              ADDS     r0,r0,#1              ;495
00004c  e9cd0401          STRD     r0,r4,[sp,#4]         ;495
000050  9100              STR      r1,[sp,#0]            ;495
000052  4811              LDR      r0,|L37.152|
000054  7a32              LDRB     r2,[r6,#8]            ;495  ; BridgeDirection
000056  3022              ADDS     r0,r0,#0x22           ;495
000058  a111              ADR      r1,|L37.160|
00005a  5c83              LDRB     r3,[r0,r2]            ;495
00005c  a804              ADD      r0,sp,#0x10           ;495
00005e  f7fffffe          BL       __2sprintf
000062  b14c              CBZ      r4,|L37.120|
000064  2001              MOVS     r0,#1                 ;504
000066  7170              STRB     r0,[r6,#5]            ;504
000068  7cb0              LDRB     r0,[r6,#0x12]         ;505  ; BalanceBmuIndex
00006a  2300              MOVS     r3,#0                 ;505
00006c  1c40              ADDS     r0,r0,#1              ;505
00006e  b2c0              UXTB     r0,r0                 ;505
000070  2201              MOVS     r2,#1                 ;505
000072  4621              MOV      r1,r4                 ;505
000074  f7fffffe          BL       drv_bq796xx_CellBalance_1to8_set
                  |L37.120|
000078  f7fffffe          BL       isLastBmuForBalance
00007c  b110              CBZ      r0,|L37.132|
00007e  f7fffffe          BL       getNextSubFunctionPointer
000082  e7ca              B        |L37.26|
                  |L37.132|
000084  2c00              CMP      r4,#0                 ;513
000086  d1c8              BNE      |L37.26|
000088  1c6d              ADDS     r5,r5,#1              ;480
00008a  b2ed              UXTB     r5,r5                 ;480
                  |L37.140|
00008c  f7fffffe          BL       apiSysParGetBmuNumber
000090  42a8              CMP      r0,r5                 ;480
000092  d8c4              BHI      |L37.30|
000094  e7c1              B        |L37.26|
;;;517    
                          ENDP

000096  0000              DCW      0x0000
                  |L37.152|
                          DCD      ||.data||
                  |L37.156|
                          DCD      ||.bss||
                  |L37.160|
0000a0  4469723d          DCB      "Dir=%d Bmu#=%d Odd=%d Bmu=%d Balance Lo = %.2X",0
0000a4  25642042
0000a8  6d75233d
0000ac  2564204f
0000b0  64643d25
0000b4  6420426d
0000b8  753d2564
0000bc  2042616c
0000c0  616e6365
0000c4  204c6f20
0000c8  3d20252e
0000cc  325800  
0000cf  00                DCB      0

                          AREA ||i.sendOutReadCellVoltageCommand||, CODE, READONLY, ALIGN=2

                  sendOutReadCellVoltageCommand PROC
;;;324    
;;;325    static void sendOutReadCellVoltageCommand(void)
000000  b510              PUSH     {r4,lr}
;;;326    {
;;;327    	drv_bq796xx_clean_fifo();
000002  f7fffffe          BL       drv_bq796xx_clean_fifo
;;;328    	drv_bq796xx_Read_AFE_ALL_VCELL(STACK, 0, 0);//BQ796XX_CMD_DELAY_MS);       //Stack(BMU #1,#2) Read all VCell 1~16(Main ADC).
000006  2200              MOVS     r2,#0
000008  4611              MOV      r1,r2
00000a  2001              MOVS     r0,#1
00000c  f7fffffe          BL       drv_bq796xx_Read_AFE_ALL_VCELL
;;;329    		
;;;330    	delayCount = 1 + (StackCountForIni[BridgeDirection] / 2);
000010  4909              LDR      r1,|L38.56|
000012  2301              MOVS     r3,#1
000014  f1a10022          SUB      r0,r1,#0x22
000018  7a02              LDRB     r2,[r0,#8]  ; BridgeDirection
00001a  5c89              LDRB     r1,[r1,r2]
00001c  eb030351          ADD      r3,r3,r1,LSR #1
000020  7703              STRB     r3,[r0,#0x1c]
;;;331    	PaserCount = StackCountForIni[BridgeDirection];
000022  7601              STRB     r1,[r0,#0x18]
;;;332    	PaserIndex = 0;
000024  2100              MOVS     r1,#0
000026  7641              STRB     r1,[r0,#0x19]
;;;333    	PaserCountPerOneTimes = PASER_COUNT_PER_ONE_TIMES;
000028  2303              MOVS     r3,#3
00002a  7683              STRB     r3,[r0,#0x1a]
;;;334    	RealPaserCount[BridgeDirection] = 0;
00002c  3024              ADDS     r0,r0,#0x24
00002e  5481              STRB     r1,[r0,r2]
;;;335    	getNextSubFunctionPointer();
000030  e8bd4010          POP      {r4,lr}
000034  f7ffbffe          B.W      getNextSubFunctionPointer
;;;336    }
;;;337    
                          ENDP

                  |L38.56|
                          DCD      ||.data||+0x22

                          AREA ||i.sendOutReadGpioCommand||, CODE, READONLY, ALIGN=2

                  sendOutReadGpioCommand PROC
;;;232    
;;;233    static void sendOutReadGpioCommand(void)
000000  b510              PUSH     {r4,lr}
;;;234    {
;;;235    	//halAfeBq796xxDebugMsg("sendOutReadGpioCommand");
;;;236    	
;;;237    	drv_bq796xx_clean_fifo();
000002  f7fffffe          BL       drv_bq796xx_clean_fifo
;;;238    	drv_bq796xx_Read_AFE_ALL_ADC(STACK, 0, 0);//BQ796XX_CMD_DELAY_MS);         //Stack(BMU #1,#2) Read all AUX ADC   (GPIO1~8).
000006  2200              MOVS     r2,#0
000008  4611              MOV      r1,r2
00000a  2001              MOVS     r0,#1
00000c  f7fffffe          BL       drv_bq796xx_Read_AFE_ALL_ADC
;;;239    	
;;;240    	delayCount = 1 + StackCountForIni[BridgeDirection] / 4;
000010  4909              LDR      r1,|L39.56|
000012  2301              MOVS     r3,#1
000014  f1a10022          SUB      r0,r1,#0x22
000018  7a02              LDRB     r2,[r0,#8]  ; BridgeDirection
00001a  5c89              LDRB     r1,[r1,r2]
00001c  eb030391          ADD      r3,r3,r1,LSR #2
000020  7703              STRB     r3,[r0,#0x1c]
;;;241    	PaserCount = StackCountForIni[BridgeDirection];
000022  7601              STRB     r1,[r0,#0x18]
;;;242    	PaserIndex = 0;
000024  2300              MOVS     r3,#0
000026  7643              STRB     r3,[r0,#0x19]
;;;243    	PaserCountPerOneTimes = PaserCount;
000028  7681              STRB     r1,[r0,#0x1a]
;;;244    	RealPaserCount[BridgeDirection] = 0;
00002a  3024              ADDS     r0,r0,#0x24
00002c  5483              STRB     r3,[r0,r2]
;;;245    	getNextSubFunctionPointer();
00002e  e8bd4010          POP      {r4,lr}
000032  f7ffbffe          B.W      getNextSubFunctionPointer
;;;246    }
;;;247    static void paserAfeResponse(void)
                          ENDP

000036  0000              DCW      0x0000
                  |L39.56|
                          DCD      ||.data||+0x22

                          AREA ||i.sendOutReadOtUtFlagCommand||, CODE, READONLY, ALIGN=2

                  sendOutReadOtUtFlagCommand PROC
;;;408    
;;;409    static void sendOutReadOtUtFlagCommand(void)
000000  b510              PUSH     {r4,lr}
;;;410    {
;;;411    	drv_bq796xx_clean_fifo();
000002  f7fffffe          BL       drv_bq796xx_clean_fifo
;;;412    	drv_bq796xx_Read_Stack_FaultOTUT(0);//BQ796XX_CMD_DELAY_MS);
000006  2000              MOVS     r0,#0
000008  f7fffffe          BL       drv_bq796xx_Read_Stack_FaultOTUT
;;;413    
;;;414    	delayCount = 1 + (StackCountForIni[BridgeDirection] / 8);
00000c  4909              LDR      r1,|L40.52|
00000e  2301              MOVS     r3,#1
000010  f1a10022          SUB      r0,r1,#0x22
000014  7a02              LDRB     r2,[r0,#8]  ; BridgeDirection
000016  5c89              LDRB     r1,[r1,r2]
000018  eb0303d1          ADD      r3,r3,r1,LSR #3
00001c  7703              STRB     r3,[r0,#0x1c]
;;;415    	PaserCount = StackCountForIni[BridgeDirection];
00001e  7601              STRB     r1,[r0,#0x18]
;;;416    	PaserIndex = 0;
000020  2300              MOVS     r3,#0
000022  7643              STRB     r3,[r0,#0x19]
;;;417    	PaserCountPerOneTimes = PaserCount;
000024  7681              STRB     r1,[r0,#0x1a]
;;;418    	RealPaserCount[BridgeDirection] = 0;
000026  3024              ADDS     r0,r0,#0x24
000028  5483              STRB     r3,[r0,r2]
;;;419    	getNextSubFunctionPointer();
00002a  e8bd4010          POP      {r4,lr}
00002e  f7ffbffe          B.W      getNextSubFunctionPointer
;;;420    }
;;;421    
                          ENDP

000032  0000              DCW      0x0000
                  |L40.52|
                          DCD      ||.data||+0x22

                          AREA ||i.sendOutReadOvUvFlagCommand||, CODE, READONLY, ALIGN=2

                  sendOutReadOvUvFlagCommand PROC
;;;381    
;;;382    static void sendOutReadOvUvFlagCommand(void)
000000  b510              PUSH     {r4,lr}
;;;383    {	
;;;384    	drv_bq796xx_clean_fifo();
000002  f7fffffe          BL       drv_bq796xx_clean_fifo
;;;385    	drv_bq796xx_Read_Stack_FaultOVUV(0);//BQ796XX_CMD_DELAY_MS);               //Stack Reaf fault OV, UV Cell Detection.
000006  2000              MOVS     r0,#0
000008  f7fffffe          BL       drv_bq796xx_Read_Stack_FaultOVUV
;;;386    
;;;387    	delayCount = 1 + (StackCountForIni[BridgeDirection] / 8);
00000c  4909              LDR      r1,|L41.52|
00000e  2301              MOVS     r3,#1
000010  f1a10022          SUB      r0,r1,#0x22
000014  7a02              LDRB     r2,[r0,#8]  ; BridgeDirection
000016  5c89              LDRB     r1,[r1,r2]
000018  eb0303d1          ADD      r3,r3,r1,LSR #3
00001c  7703              STRB     r3,[r0,#0x1c]
;;;388    	PaserCount = StackCountForIni[BridgeDirection];
00001e  7601              STRB     r1,[r0,#0x18]
;;;389    	PaserIndex = 0;
000020  2300              MOVS     r3,#0
000022  7643              STRB     r3,[r0,#0x19]
;;;390    	PaserCountPerOneTimes = PaserCount;
000024  7681              STRB     r1,[r0,#0x1a]
;;;391    	RealPaserCount[BridgeDirection] = 0;
000026  3024              ADDS     r0,r0,#0x24
000028  5483              STRB     r3,[r0,r2]
;;;392    	getNextSubFunctionPointer();
00002a  e8bd4010          POP      {r4,lr}
00002e  f7ffbffe          B.W      getNextSubFunctionPointer
;;;393    }
;;;394    
                          ENDP

000032  0000              DCW      0x0000
                  |L41.52|
                          DCD      ||.data||+0x22

                          AREA ||i.sendOutReadSummaryCommand||, CODE, READONLY, ALIGN=2

                  sendOutReadSummaryCommand PROC
;;;352    
;;;353    static void sendOutReadSummaryCommand(void)
000000  b510              PUSH     {r4,lr}
;;;354    {
;;;355    	drv_bq796xx_clean_fifo();
000002  f7fffffe          BL       drv_bq796xx_clean_fifo
;;;356    	drv_bq796xx_Read_Stack_FaultSummary(0);//BQ796XX_CMD_DELAY_MS);            //Stack Read fault summary.
000006  2000              MOVS     r0,#0
000008  f7fffffe          BL       drv_bq796xx_Read_Stack_FaultSummary
;;;357    
;;;358    	delayCount = 1 + (StackCountForIni[BridgeDirection] / 8);
00000c  4909              LDR      r1,|L42.52|
00000e  2301              MOVS     r3,#1
000010  f1a10022          SUB      r0,r1,#0x22
000014  7a02              LDRB     r2,[r0,#8]  ; BridgeDirection
000016  5c89              LDRB     r1,[r1,r2]
000018  eb0303d1          ADD      r3,r3,r1,LSR #3
00001c  7703              STRB     r3,[r0,#0x1c]
;;;359    	PaserCount = StackCountForIni[BridgeDirection];
00001e  7601              STRB     r1,[r0,#0x18]
;;;360    	PaserIndex = 0;
000020  2300              MOVS     r3,#0
000022  7643              STRB     r3,[r0,#0x19]
;;;361    	PaserCountPerOneTimes = PaserCount;
000024  7681              STRB     r1,[r0,#0x1a]
;;;362    	RealPaserCount[BridgeDirection] = 0;
000026  3024              ADDS     r0,r0,#0x24
000028  5483              STRB     r3,[r0,r2]
;;;363    	getNextSubFunctionPointer();
00002a  e8bd4010          POP      {r4,lr}
00002e  f7ffbffe          B.W      getNextSubFunctionPointer
;;;364    }
;;;365    
                          ENDP

000032  0000              DCW      0x0000
                  |L42.52|
                          DCD      ||.data||+0x22

                          AREA ||i.setNtcChannel||, CODE, READONLY, ALIGN=2

                  setNtcChannel PROC
;;;181    static uint8_t	NtcChannelSelect = 0;
;;;182    static void setNtcChannel(void)
000000  b538              PUSH     {r3-r5,lr}
;;;183    {
;;;184    	char	str[100];
;;;185    
;;;186    	uint16_t test_gpio_HL=0;
;;;187    	
;;;188    	NtcChannelSelect = ntcChannelStartIndex + ntcChannelOffset;
000002  4d29              LDR      r5,|L43.168|
000004  7be8              LDRB     r0,[r5,#0xf]  ; ntcChannelStartIndex
000006  7c29              LDRB     r1,[r5,#0x10]  ; ntcChannelOffset
000008  4408              ADD      r0,r0,r1
00000a  b2c0              UXTB     r0,r0
00000c  7468              STRB     r0,[r5,#0x11]
;;;189    	if(NtcChannelSelect >= NTC_CH_NUM)
00000e  2810              CMP      r0,#0x10
000010  d301              BCC      |L43.22|
;;;190    		NtcChannelSelect -= NTC_CH_NUM;
000012  3810              SUBS     r0,r0,#0x10
000014  7468              STRB     r0,[r5,#0x11]
                  |L43.22|
;;;191    
;;;192    	if(ntcIoIndex == 0)
000016  7ba8              LDRB     r0,[r5,#0xe]  ; ntcIoIndex
000018  2400              MOVS     r4,#0
00001a  b130              CBZ      r0,|L43.42|
;;;193    	{
;;;194    		//sprintf(str,"Dir = %d NTC Channel = %d",BridgeDirection, NtcChannelSelect);
;;;195    		//halAfeBq796xxDebugMsg(str);
;;;196    		
;;;197    	    test_gpio_HL = 5- (NtcChannelSelect & 0x01);	
;;;198    		drv_bq796xx_Set_AFE_GPIO_type(STACK, 0x00, test_gpio_HL, AFE_GPIO4,0);//BQ796XX_CMD_DELAY_MS);
;;;199    	}
;;;200    	else if(ntcIoIndex == 1)
00001c  2801              CMP      r0,#1
00001e  d010              BEQ      |L43.66|
;;;201    	{
;;;202    		test_gpio_HL = 5-((NtcChannelSelect & 0x02)>>1);
;;;203    		drv_bq796xx_Set_AFE_GPIO_type(STACK, 0x00, test_gpio_HL, AFE_GPIO5,0);//BQ796XX_CMD_DELAY_MS);	
;;;204    	}
;;;205    	else if(ntcIoIndex == 2)
000020  2802              CMP      r0,#2
000022  d01a              BEQ      |L43.90|
;;;206    	{	
;;;207    		test_gpio_HL = 5-((NtcChannelSelect & 0x04)>>2);
;;;208    		drv_bq796xx_Set_AFE_GPIO_type(STACK, 0x00, test_gpio_HL, AFE_GPIO6,0);//BQ796XX_CMD_DELAY_MS);
;;;209    	}
;;;210    	else if(ntcIoIndex == 3)
000024  2803              CMP      r0,#3
000026  d024              BEQ      |L43.114|
000028  e02e              B        |L43.136|
                  |L43.42|
00002a  7c68              LDRB     r0,[r5,#0x11]         ;197  ; NtcChannelSelect
00002c  f0000001          AND      r0,r0,#1              ;197
000030  f1c00205          RSB      r2,r0,#5              ;197
000034  2303              MOVS     r3,#3                 ;198
000036  2100              MOVS     r1,#0                 ;198
000038  2001              MOVS     r0,#1                 ;198
00003a  9400              STR      r4,[sp,#0]            ;198
00003c  f7fffffe          BL       drv_bq796xx_Set_AFE_GPIO_type
000040  e022              B        |L43.136|
                  |L43.66|
000042  7c68              LDRB     r0,[r5,#0x11]         ;202  ; NtcChannelSelect
000044  f3c00040          UBFX     r0,r0,#1,#1           ;202
000048  f1c00205          RSB      r2,r0,#5              ;202
00004c  2304              MOVS     r3,#4                 ;203
00004e  2100              MOVS     r1,#0                 ;203
000050  2001              MOVS     r0,#1                 ;203
000052  9400              STR      r4,[sp,#0]            ;203
000054  f7fffffe          BL       drv_bq796xx_Set_AFE_GPIO_type
000058  e016              B        |L43.136|
                  |L43.90|
00005a  7c68              LDRB     r0,[r5,#0x11]         ;207  ; NtcChannelSelect
00005c  f3c00080          UBFX     r0,r0,#2,#1           ;207
000060  f1c00205          RSB      r2,r0,#5              ;207
000064  2305              MOVS     r3,#5                 ;208
000066  2100              MOVS     r1,#0                 ;208
000068  2001              MOVS     r0,#1                 ;208
00006a  9400              STR      r4,[sp,#0]            ;208
00006c  f7fffffe          BL       drv_bq796xx_Set_AFE_GPIO_type
000070  e00a              B        |L43.136|
                  |L43.114|
;;;211    	{
;;;212    		test_gpio_HL = 5-((NtcChannelSelect & 0x08)>>3);
000072  7c68              LDRB     r0,[r5,#0x11]  ; NtcChannelSelect
000074  f3c000c0          UBFX     r0,r0,#3,#1
000078  f1c00205          RSB      r2,r0,#5
;;;213    		drv_bq796xx_Set_AFE_GPIO_type(STACK, 0x00, test_gpio_HL, AFE_GPIO7,0);//BQ796XX_CMD_DELAY_MS);
00007c  2306              MOVS     r3,#6
00007e  2100              MOVS     r1,#0
000080  2001              MOVS     r0,#1
000082  9400              STR      r4,[sp,#0]
000084  f7fffffe          BL       drv_bq796xx_Set_AFE_GPIO_type
                  |L43.136|
;;;214    	}
;;;215    	
;;;216    	ntcIoIndex++;
000088  7ba8              LDRB     r0,[r5,#0xe]  ; ntcIoIndex
00008a  1c40              ADDS     r0,r0,#1
00008c  b2c0              UXTB     r0,r0
00008e  73a8              STRB     r0,[r5,#0xe]
;;;217    	if(ntcIoIndex >= 4)
000090  2804              CMP      r0,#4
000092  d305              BCC      |L43.160|
;;;218    	{
;;;219    		ntcChannelOffset++;
000094  7c28              LDRB     r0,[r5,#0x10]  ; ntcChannelOffset
000096  1c40              ADDS     r0,r0,#1
000098  7428              STRB     r0,[r5,#0x10]
;;;220    		ntcIoIndex = 0;
00009a  73ac              STRB     r4,[r5,#0xe]
;;;221    		delayCount = 10;
00009c  200a              MOVS     r0,#0xa
00009e  7728              STRB     r0,[r5,#0x1c]
                  |L43.160|
;;;222    	}
;;;223    	getNextSubFunctionPointer();
0000a0  e8bd4038          POP      {r3-r5,lr}
0000a4  f7ffbffe          B.W      getNextSubFunctionPointer
;;;224    }
;;;225    static void delayFunction(void)
                          ENDP

                  |L43.168|
                          DCD      ||.data||

                          AREA ||i.setupAfe2ndOtValue||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  setupAfe2ndOtValue PROC
;;;1367   
;;;1368   static void setupAfe2ndOtValue(void)
000000  b500              PUSH     {lr}
;;;1369   {
000002  b09d              SUB      sp,sp,#0x74
;;;1370   	uint16_t	ntc_voltage;
;;;1371   	uint8_t		Percentage;
;;;1372   	tScuProtectPar	ProtectPar;
;;;1373   	char	str[100];
;;;1374   	
;;;1375   	apiSysParGet2ndOtProtectPar(&ProtectPar);
000004  a819              ADD      r0,sp,#0x64
000006  f7fffffe          BL       apiSysParGet2ndOtProtectPar
;;;1376   	ntc_voltage = LibTemperatureToVoltage(ProtectPar.SetValue.i[0]);
00000a  f9bd0064          LDRSH    r0,[sp,#0x64]
00000e  f7fffffe          BL       LibTemperatureToVoltage
;;;1377   	
;;;1378   	Percentage = converterNtcVoltageToPercentage(ntc_voltage);
000012  f7fffffe          BL       converterNtcVoltageToPercentage
;;;1379   	if(Percentage >= 10 && Percentage<= 39)
000016  380a              SUBS     r0,r0,#0xa
000018  281d              CMP      r0,#0x1d
00001a  d801              BHI      |L44.32|
;;;1380   	{
;;;1381   		Percentage -= 10;
00001c  b2c2              UXTB     r2,r0
;;;1382   		Percentage += OT_10_PCT;
00001e  e000              B        |L44.34|
                  |L44.32|
;;;1383   	}
;;;1384   	else 
;;;1385   		Percentage = OT_10_PCT;
000020  2200              MOVS     r2,#0
                  |L44.34|
;;;1386   	afe_load_data.ot_threshold = Percentage;
000022  4804              LDR      r0,|L44.52|
000024  70c2              STRB     r2,[r0,#3]
;;;1387   	
;;;1388   	sprintf(str,"Sen OT = %d",10 + Percentage);
000026  320a              ADDS     r2,r2,#0xa
000028  a103              ADR      r1,|L44.56|
00002a  4668              MOV      r0,sp
00002c  f7fffffe          BL       __2sprintf
;;;1389   	halAfeBq796xxDebugMsg(str);
;;;1390   // .ot_threshold         =OT_10_PCT,                      \
;;;1391   // .ut_threshold         =UT_80_PCT,                      \
;;;1392   
;;;1393   }
000030  b01d              ADD      sp,sp,#0x74
000032  bd00              POP      {pc}
;;;1394   static void setupAfe2ndUtValue(void)
                          ENDP

                  |L44.52|
                          DCD      ||.data||+0x3c
                  |L44.56|
000038  53656e20          DCB      "Sen OT = %d",0
00003c  4f54203d
000040  20256400

                          AREA ||i.setupAfe2ndOvValue||, CODE, READONLY, ALIGN=2

                  setupAfe2ndOvValue PROC
;;;1308   
;;;1309   static void setupAfe2ndOvValue(void)
000000  b51f              PUSH     {r0-r4,lr}
;;;1310   {
;;;1311   	#define	OV_STEP_MV					25
;;;1312   	tScuProtectPar	ProtectPar;
;;;1313   	uint16_t		setvalue;	
;;;1314   	apiSysParGetOvpPar(HW_2ND_PROTECT_PAR_INDEX, &ProtectPar);
000002  4669              MOV      r1,sp
000004  2010              MOVS     r0,#0x10
000006  f7fffffe          BL       apiSysParGetOvpPar
;;;1315   
;;;1316   	if(ProtectPar.SetValue.l >= 2700 && ProtectPar.SetValue.l <= 3000)
00000a  9800              LDR      r0,[sp,#0]
00000c  f44f7396          MOV      r3,#0x12c
000010  f6a0218c          SUB      r1,r0,#0xa8c
;;;1317   	{
;;;1318   		setvalue = ProtectPar.SetValue.l - 2700;
;;;1319   		setvalue += (OV_STEP_MV - 1);
;;;1320   		setvalue /= OV_STEP_MV;
000014  2219              MOVS     r2,#0x19
000016  4299              CMP      r1,r3                 ;1316
000018  d806              BHI      |L45.40|
00001a  3118              ADDS     r1,r1,#0x18           ;1319
00001c  b288              UXTH     r0,r1                 ;1319
00001e  fbb0f0f2          UDIV     r0,r0,r2
;;;1321   		setvalue += OV_2700MV;
000022  1c80              ADDS     r0,r0,#2
000024  b280              UXTH     r0,r0
000026  e017              B        |L45.88|
                  |L45.40|
;;;1322   	}
;;;1323   	else if(ProtectPar.SetValue.l >= 3500 && ProtectPar.SetValue.l <= 3800)
000028  f6a051ac          SUB      r1,r0,#0xdac
00002c  4299              CMP      r1,r3
00002e  d806              BHI      |L45.62|
;;;1324   	{
;;;1325   		setvalue = ProtectPar.SetValue.l - 3500;
;;;1326   		setvalue += (OV_STEP_MV - 1);
000030  3118              ADDS     r1,r1,#0x18
000032  b288              UXTH     r0,r1
;;;1327   		setvalue /= OV_STEP_MV;
000034  fbb0f0f2          UDIV     r0,r0,r2
;;;1328   		setvalue += OV_3500MV;
000038  3012              ADDS     r0,r0,#0x12
00003a  b280              UXTH     r0,r0
00003c  e00c              B        |L45.88|
                  |L45.62|
;;;1329   	}
;;;1330   	else if(ProtectPar.SetValue.l >= 4175 && ProtectPar.SetValue.l <= 4475)
00003e  f5a05080          SUB      r0,r0,#0x1000
000042  384f              SUBS     r0,r0,#0x4f
000044  4298              CMP      r0,r3
000046  d806              BHI      |L45.86|
;;;1331   	{
;;;1332   		setvalue = ProtectPar.SetValue.l - 4175;
;;;1333   		setvalue += (OV_STEP_MV - 1);
000048  3018              ADDS     r0,r0,#0x18
00004a  b280              UXTH     r0,r0
;;;1334   		setvalue /= OV_STEP_MV;
00004c  fbb0f0f2          UDIV     r0,r0,r2
;;;1335   		setvalue += OV_4175MV;
000050  3022              ADDS     r0,r0,#0x22
000052  b280              UXTH     r0,r0
000054  e000              B        |L45.88|
                  |L45.86|
;;;1336   	}
;;;1337   	else
;;;1338   		setvalue = 0x3f;
000056  203f              MOVS     r0,#0x3f
                  |L45.88|
;;;1339   	afe_load_data.ov_threshold = setvalue;		  
000058  4901              LDR      r1,|L45.96|
00005a  7008              STRB     r0,[r1,#0]
;;;1340   }
00005c  bd1f              POP      {r0-r4,pc}
;;;1341   static void setupAfe2ndUvValue(void)
                          ENDP

00005e  0000              DCW      0x0000
                  |L45.96|
                          DCD      ||.data||+0x3c

                          AREA ||i.setupAfe2ndUtValue||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  setupAfe2ndUtValue PROC
;;;1393   }
;;;1394   static void setupAfe2ndUtValue(void)
000000  b500              PUSH     {lr}
;;;1395   {
000002  b09d              SUB      sp,sp,#0x74
;;;1396   	uint16_t	ntc_voltage;
;;;1397   	uint8_t		Percentage;
;;;1398   	tScuProtectPar	ProtectPar;
;;;1399   	char	str[100];
;;;1400   	
;;;1401   	apiSysParGet2ndUtProtectPar(&ProtectPar);
000004  a819              ADD      r0,sp,#0x64
000006  f7fffffe          BL       apiSysParGet2ndUtProtectPar
;;;1402   	ntc_voltage = LibTemperatureToVoltage(ProtectPar.SetValue.i[0]);
00000a  f9bd0064          LDRSH    r0,[sp,#0x64]
00000e  f7fffffe          BL       LibTemperatureToVoltage
;;;1403   	
;;;1404   	Percentage = converterNtcVoltageToPercentage(ntc_voltage);
000012  f7fffffe          BL       converterNtcVoltageToPercentage
;;;1405   	if(Percentage >= 66 && Percentage<= 80)
000016  3842              SUBS     r0,r0,#0x42
000018  280e              CMP      r0,#0xe
00001a  d802              BHI      |L46.34|
;;;1406   	{
;;;1407   		Percentage -= 66;
00001c  b2c0              UXTB     r0,r0
;;;1408   		Percentage /= 2;
00001e  0840              LSRS     r0,r0,#1
;;;1409   		Percentage += UT_66_PCT;
000020  e000              B        |L46.36|
                  |L46.34|
;;;1410   	}
;;;1411   	else 
;;;1412   		Percentage = UT_80_PCT;
000022  2007              MOVS     r0,#7
                  |L46.36|
;;;1413   	afe_load_data.ut_threshold = Percentage;
000024  4905              LDR      r1,|L46.60|
000026  7108              STRB     r0,[r1,#4]
;;;1414   	
;;;1415   	sprintf(str,"Sen UT = %d",66 + (Percentage * 2));
000028  2142              MOVS     r1,#0x42
00002a  eb010240          ADD      r2,r1,r0,LSL #1
00002e  a104              ADR      r1,|L46.64|
000030  4668              MOV      r0,sp
000032  f7fffffe          BL       __2sprintf
;;;1416   	halAfeBq796xxDebugMsg(str);
;;;1417   }
000036  b01d              ADD      sp,sp,#0x74
000038  bd00              POP      {pc}
;;;1418   
                          ENDP

00003a  0000              DCW      0x0000
                  |L46.60|
                          DCD      ||.data||+0x3c
                  |L46.64|
000040  53656e20          DCB      "Sen UT = %d",0
000044  5554203d
000048  20256400

                          AREA ||i.setupAfe2ndUvValue||, CODE, READONLY, ALIGN=2

                  setupAfe2ndUvValue PROC
;;;1340   }
;;;1341   static void setupAfe2ndUvValue(void)
000000  b51f              PUSH     {r0-r4,lr}
;;;1342   {
;;;1343   	#define	UV_STEP_MV			50
;;;1344   	tScuProtectPar	ProtectPar;
;;;1345   	uint16_t		setvalue;	
;;;1346   	apiSysParGetUvpPar(HW_2ND_PROTECT_PAR_INDEX, &ProtectPar);
000002  4669              MOV      r1,sp
000004  2010              MOVS     r0,#0x10
000006  f7fffffe          BL       apiSysParGetUvpPar
;;;1347   
;;;1348   	if(ProtectPar.SetValue.l >= 1200 && ProtectPar.SetValue.l <= 3100)
00000a  9800              LDR      r0,[sp,#0]
00000c  f240716c          MOV      r1,#0x76c
000010  f5a06096          SUB      r0,r0,#0x4b0
000014  4288              CMP      r0,r1
000016  d805              BHI      |L47.36|
;;;1349   	{
;;;1350   		setvalue = ProtectPar.SetValue.l - 1200;
;;;1351   		setvalue += (UV_STEP_MV - 1);
000018  3031              ADDS     r0,r0,#0x31
00001a  b280              UXTH     r0,r0
;;;1352   		setvalue /= UV_STEP_MV;
00001c  2132              MOVS     r1,#0x32
00001e  fbb0f0f1          UDIV     r0,r0,r1
000022  e000              B        |L47.38|
                  |L47.36|
;;;1353   	}
;;;1354   	else
;;;1355   		setvalue = UV_2500MV;
000024  201a              MOVS     r0,#0x1a
                  |L47.38|
;;;1356   	afe_load_data.uv_threshold = setvalue;
000026  4901              LDR      r1,|L47.44|
000028  7088              STRB     r0,[r1,#2]
;;;1357   }
00002a  bd1f              POP      {r0-r4,pc}
;;;1358   uint8_t	converterNtcVoltageToPercentage(uint16_t voltage)
                          ENDP

                  |L47.44|
                          DCD      ||.data||+0x3c

                          AREA ||i.startBalance||, CODE, READONLY, ALIGN=1

                  startBalance PROC
;;;1003   
;;;1004   static void startBalance(void)
000000  b510              PUSH     {r4,lr}
;;;1005   {
;;;1006   	//halAfeBq796xxDebugMsg("startBalance");
;;;1007   
;;;1008   	drv_bq796xx_Stack_CellBalanceStarting(CB_MANUAL, 0);
000002  2100              MOVS     r1,#0
000004  4608              MOV      r0,r1
000006  f7fffffe          BL       drv_bq796xx_Stack_CellBalanceStarting
;;;1009   	getNextSubFunctionPointer();
00000a  e8bd4010          POP      {r4,lr}
00000e  f7ffbffe          B.W      getNextSubFunctionPointer
;;;1010   }
;;;1011   
                          ENDP


                          AREA ||i.stopBalanceActive||, CODE, READONLY, ALIGN=1

                  stopBalanceActive PROC
;;;995    
;;;996    static void stopBalanceActive(void)
000000  b510              PUSH     {r4,lr}
;;;997    {
;;;998    	//halAfeBq796xxDebugMsg("stopBalanceActive");
;;;999    	drv_bq796xx_Stack_CellBalanceStarting(CB_MANUAL, 0);
000002  2100              MOVS     r1,#0
000004  4608              MOV      r0,r1
000006  f7fffffe          BL       drv_bq796xx_Stack_CellBalanceStarting
;;;1000   	getNextSubFunctionPointer();
00000a  e8bd4010          POP      {r4,lr}
00000e  f7ffbffe          B.W      getNextSubFunctionPointer
;;;1001   }
;;;1002   
                          ENDP


                          AREA ||i.stopBalanceHiCell||, CODE, READONLY, ALIGN=1

                  stopBalanceHiCell PROC
;;;988    }
;;;989    static void stopBalanceHiCell(void)
000000  b510              PUSH     {r4,lr}
;;;990    {
;;;991    	//halAfeBq796xxDebugMsg("stopBalanceHiCell");
;;;992    	drv_bq796xx_CellBalance_9to16_clear(STACK, 0x00, 0);
000002  2200              MOVS     r2,#0
000004  4611              MOV      r1,r2
000006  2001              MOVS     r0,#1
000008  f7fffffe          BL       drv_bq796xx_CellBalance_9to16_clear
;;;993    	getNextSubFunctionPointer();
00000c  e8bd4010          POP      {r4,lr}
000010  f7ffbffe          B.W      getNextSubFunctionPointer
;;;994    }
;;;995    
                          ENDP


                          AREA ||i.stopBalanceLoCell||, CODE, READONLY, ALIGN=1

                  stopBalanceLoCell PROC
;;;982    
;;;983    static void stopBalanceLoCell(void)
000000  b510              PUSH     {r4,lr}
;;;984    {
;;;985    	//halAfeBq796xxDebugMsg("stopBalanceLoCell");
;;;986    	drv_bq796xx_CellBalance_1to8_clear(STACK, 0x00, 0);
000002  2200              MOVS     r2,#0
000004  4611              MOV      r1,r2
000006  2001              MOVS     r0,#1
000008  f7fffffe          BL       drv_bq796xx_CellBalance_1to8_clear
;;;987    	getNextSubFunctionPointer();
00000c  e8bd4010          POP      {r4,lr}
000010  f7ffbffe          B.W      getNextSubFunctionPointer
;;;988    }
;;;989    static void stopBalanceHiCell(void)
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=1

                  BalanceData
                          %        128

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

                  stopBalanceFunctionTable
                          DCD      stopBalanceLoCell
                          DCD      stopBalanceHiCell
                          DCD      stopBalanceActive
                          DCD      getNextMainFunctionPointer
                  getNtcFunctionTable
                          DCD      setNtcChannel
                          DCD      setNtcChannel
                          DCD      setNtcChannel
                          DCD      setNtcChannel
                          DCD      delayFunction
                          DCD      sendOutReadGpioCommand
                          DCD      delayFunction
                          DCD      paserAfeResponse
                          DCD      getNextMainFunctionPointer
                  getCellVoltageFunctionTable
                          DCD      sendOutReadCellVoltageCommand
                          DCD      delayFunction
                          DCD      paserAfeResponse
                          DCD      getNextMainFunctionPointer
                  getSummaryFunctionTable
                          DCD      sendOutReadSummaryCommand
                          DCD      delayFunction
                          DCD      paserAfeResponse
                          DCD      getNextMainFunctionPointer
                  getOvUvFlagFunctionTable
                          DCD      sendOutReadOvUvFlagCommand
                          DCD      delayFunction
                          DCD      paserAfeResponse
                          DCD      getNextMainFunctionPointer
                  getOtUtFlagFunctionTable
                          DCD      sendOutReadOtUtFlagCommand
                          DCD      delayFunction
                          DCD      paserAfeResponse
                          DCD      getNextMainFunctionPointer
                  changeDirectionFunctionTable
                          DCD      finishAfeReadProcessor
                          DCD      changeBmuDirForDataReadProcessor
                          DCD      getNextMainFunctionPointer
                  startBalanceFunctionTable
                          DCD      sendOutBalanceDataLo
                          DCD      sendOutBalanceDataHi
                          DCD      startBalance
                          DCD      getNextMainFunctionPointer
                  afeMainFunctionTable
                          DCD      mainFunStopBalance
                          DCD      mainFunStartGetNtc
                          DCD      mainFunGetNtc
                          DCD      mainFunGetNtc
                          DCD      mainFunChangeChannel
                          DCD      mainFunGetCellVoltage
                          DCD      mainFunStartBalance
                          DCD      mainFunGetSummary
                          DCD      mainFunGetOvUvFlag
                          DCD      mainFunGetOtUtFlag
                          DCD      mainFunFinishAfeRead
                          DCD      mainFunEnd

                          AREA ||.data||, DATA, ALIGN=2

                  afe_steps
000000  00                DCB      0x00
                  step_com_f
000001  00                DCB      0x00
                  before_d_ms
000002  00                DCB      0x00
                  AfeCommTimeOutCount
000003  00                DCB      0x00
                  AfeCommFlag
000004  00                DCB      0x00
                  IsBalanceEnable
000005  01                DCB      0x01
                  BalanceOnFlag
000006  00                DCB      0x00
                  BalanceOddFlag
000007  00                DCB      0x00
                  BridgeDirection
000008  00                DCB      0x00
                  BridgeSwitchCount
000009  00                DCB      0x00
                  AfeState
00000a  01                DCB      0x01
                  NorthAndSouthIniFlag
00000b  00                DCB      0x00
                  MainFunIndex
00000c  00                DCB      0x00
                  wake_sw
00000d  01                DCB      0x01
                  ntcIoIndex
00000e  00                DCB      0x00
                  ntcChannelStartIndex
00000f  00                DCB      0x00
                  ntcChannelOffset
000010  00                DCB      0x00
                  NtcChannelSelect
000011  00                DCB      0x00
                  BalanceBmuIndex
000012  00                DCB      0x00
                  NtcChannel
000013  00                DCB      0x00
                  fail_count
000014  00                DCB      0x00
                  run_count
000015  00                DCB      0x00
                  ChangeDirCount
000016  00                DCB      0x00
                  count
000017  00                DCB      0x00
                  PaserCount
000018  00                DCB      0x00
                  PaserIndex
000019  00                DCB      0x00
                  PaserCountPerOneTimes
00001a  00                DCB      0x00
                  IsRingDaisyChain
00001b  00                DCB      0x00
                  delayCount
00001c  0000              DCB      0x00,0x00
                  cnt_delay
00001e  0000              DCW      0x0000
                  AfeFailTimerCount
000020  0000              DCW      0x0000
                  StackCountForIni
000022  0000              DCB      0x00,0x00
                  RealPaserCount
000024  0000              DCB      0x00,0x00
                  PaserCountFailCount
000026  0000              DCB      0x00,0x00
                  ReaAfeCycleCount10Ms
000028  0032              DCW      0x0032
00002a  0000              DCB      0x00,0x00
                  AfeTimerHandlerProcessor
                          DCD      0x00000000
                  AfeFunctionProcessor
                          DCD      0x00000000
                  afeEvtHandler
                          DCD      0x00000000
                  sunFunctionPointer
                          DCD      0x00000000
                  afe_load_data
00003c  22042000          DCB      0x22,0x04,0x20,0x00
000040  07010100          DCB      0x07,0x01,0x01,0x00
000044  000100            DCB      0x00,0x01,0x00

                          AREA ||area_number.57||, DATA, ALIGN=1

                          EXPORTAS ||area_number.57||, ||.data||
                  bq_count_temp
000000  0000              DCW      0x0000

;*** Start embedded assembler ***

#line 1 "..\\..\\..\\HAL\\HalAfeBq796xx.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___15_HalAfeBq796xx_c_ee24cc3f____REV16|
#line 492 "../../../Drivers/CMSIS/Include/cmsis_armcc.h"
|__asm___15_HalAfeBq796xx_c_ee24cc3f____REV16| PROC
#line 493

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___15_HalAfeBq796xx_c_ee24cc3f____REVSH|
#line 507
|__asm___15_HalAfeBq796xx_c_ee24cc3f____REVSH| PROC
#line 508

 revsh r0, r0
 bx lr
	ENDP
	AREA ||.rrx_text||, CODE
	THUMB
	EXPORT |__asm___15_HalAfeBq796xx_c_ee24cc3f____RRX|
#line 694
|__asm___15_HalAfeBq796xx_c_ee24cc3f____RRX| PROC
#line 695

 rrx r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
